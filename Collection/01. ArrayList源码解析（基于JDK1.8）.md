> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![å…¬ä¼—å·äºŒç»´ç ](https://img-blog.csdnimg.cn/20201121225359995.png)

----


## æ¦‚è¿°

![å›¾1-1 å…¨æ–‡æ€ç»´å¯¼å›¾](https://img-blog.csdnimg.cn/2020111519062042.png?x-oss-process=image)

```ArrayList``` æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œå¹¶ä¸”æ”¯æŒ ```åŠ¨æ€æ‰©å®¹``` çš„åŠ¨æ€æ•°ç»„ã€‚ç›¸æ¯”äºæ•°ç»„è€Œè¨€ï¼Œå› ä¸ºå…¶æ”¯æŒ ```è‡ªåŠ¨æ‰©å®¹``` çš„ç‰¹æ€§ï¼Œæˆä¸ºæˆ‘ä»¬åœ¨å¼€å‘ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ã€‚

æœ¬ç¯‡çš„è®²è§£æ˜¯åŸºäº ```JDK1.8```ï¼Œè¯ä¸å¤šè¯´ï¼Œ å°±è®©æˆ‘ä»¬ç¿»å¼€ ```ArrayList``` çš„æºä»£ç ï¼Œé¨æ¸¸ä¸€ç•ªå§~

```Let's GO !!!```

## ç±»å›¾

![å›¾ 1-2 ArrayListç±»å›¾](https://img-blog.csdnimg.cn/20201114133453233.png?x-oss-process=image)

ä»ç±»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ```ArrayList``` å®ç°äº†4ä¸ªæ¥å£å’Œç»§æ‰¿äº†1ä¸ªæŠ½è±¡ç±»ï¼›4ä¸ªæ¥å£åˆ†åˆ«ä¸ºï¼š

- ```List``` æ¥å£ï¼Œä¸»è¦æä¾›æ•°ç»„çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€è¿­ä»£éå†ç­‰æ“ä½œã€‚

- ```Cloneable``` æ¥å£ï¼Œè¡¨ç¤ºArrayListæ”¯æŒå…‹éš†ã€‚

- ```RandomAccess``` æ¥å£ï¼Œè¡¨ç¤ºArrayListæ”¯æŒ ```å¿«é€Ÿ``` çš„éšæœºè®¿é—®ã€‚

- ```Serializable``` æ¥å£ï¼Œè¡¨ç¤ºArrayListæ”¯æŒåºåˆ—åŒ–çš„åŠŸèƒ½ã€‚

ç»§æ‰¿çš„æŠ½è±¡ç±»ä¸º ```AbstractList```ï¼Œä¸»è¦æä¾›çš„æ˜¯ ```è¿­ä»£éå†``` ç›¸å…³çš„æ“ä½œï¼›å¦‚æœæˆ‘ä»¬å•çº¯çœ‹ ```List --> AbstractList --> ArrayList``` è¿™ä¸€å®ç°/ç»§æ‰¿å…³ç³»æ¥çœ‹çš„ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸€ç§ ```æ¨¡æ¿æ–¹æ³•æ¨¡å¼``` çš„æ„Ÿè§‰å‘¢ï¼Ÿ ```List``` æ¥å£å®šä¹‰äº†æ“ä½œè¡Œä¸ºï¼Œ```AbstractList``` æŠ½è±¡ç±»æä¾›äº†å¯é‡ç”¨çš„ ```ç®—æ³•éª¨æ¶```ï¼›è€Œæœ€ç»ˆçš„ ```ArrayList``` å®ç°ç±»æ ¹æ®è‡ªå·±çš„æƒ…å†µè‡ªå®šä¹‰å®ç°æ¥å£ã€‚

æ³¨æ„ï¼šå®é™…ä¸Š ```ArrayList``` å¤§é‡é‡å†™äº† ```AbstractList``` æŠ½è±¡ç±»æä¾›çš„æ–¹æ³•å®ç°ï¼›æ‰€ä»¥ ```AbstractList``` å¯¹ ```ArrayList``` æ¥è¯´æ„ä¹‰ä¸å¤§ï¼Œä½†ä¸è¿‡ ```AbstractList``` çš„å…¶ä»–å¾ˆå¤šå­ç±»äº«å—åˆ°äº†è¿™ä¸ªç¦åˆ©ã€‚

```java
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable
{
    // ....
}
```

## æºç è§£æ

åœ¨è¿›è¡Œæºç è§£æå‰ï¼Œæˆ‘ä»¬å…ˆå…¨è§ˆä¸€ç¯‡ ```ArrayList``` ä¸­çš„æ‰€æœ‰æ–¹æ³•å§ï¼Œå¹¶ä¸”æŒ‘é€‰æ¯”è¾ƒæ ¸å¿ƒçš„æ–¹æ³•è¿›è¡Œè®²è§£ã€‚

```java
/****************** ArrayListä¸­çš„æ„é€ å‡½æ•° ***************/
// é»˜è®¤æ„é€ å‡½æ•°
ArrayList()

// capacityæ˜¯ArrayListçš„é»˜è®¤å®¹é‡å¤§å°ã€‚å½“ç”±äºå¢åŠ æ•°æ®å¯¼è‡´å®¹é‡ä¸è¶³æ—¶ï¼Œå®¹é‡ä¼šæ·»åŠ ä¸Šä¸€æ¬¡å®¹é‡å¤§å°çš„ä¸€åŠã€‚
ArrayList(int capacity)

// åˆ›å»ºä¸€ä¸ªåŒ…å«collectionçš„ArrayList
ArrayList(Collection<? extends E> collection)

/****************** ArrayListä¸­çš„API ********************/
// Collectionä¸­å®šä¹‰çš„API
boolean             add(E object)
boolean             addAll(Collection<? extends E> collection)
void                clear()
boolean             contains(Object object)
boolean             containsAll(Collection<?> collection)
boolean             equals(Object object)
int                 hashCode()
boolean             isEmpty()
Iterator<E>         iterator()
boolean             remove(Object object)
boolean             removeAll(Collection<?> collection)
boolean             retainAll(Collection<?> collection)
int                 size()
<T> T[]             toArray(T[] array)
Object[]            toArray()

// AbstractCollectionä¸­å®šä¹‰çš„API
void                add(int location, E object)
boolean             addAll(int location, Collection<? extends E> collection)
E                   get(int location)
int                 indexOf(Object object)
int                 lastIndexOf(Object object)
ListIterator<E>     listIterator(int location)
ListIterator<E>     listIterator()
E                   remove(int location)
E                   set(int location, E object)
List<E>             subList(int start, int end)

// ArrayListæ–°å¢çš„API
Object               clone()
void                 ensureCapacity(int minimumCapacity)
void                 trimToSize()
void                 removeRange(int fromIndex, int toIndex)
```

### å±æ€§

```ArrayList``` çš„å±æ€§å¾ˆå°‘ï¼Œåªæœ‰2ä¸ªå±æ€§ï¼š ```elementData``` å’Œ ```size```ï¼›å…¶ä¸­ ```elementData``` ä»£è¡¨çš„æ˜¯å­˜æ”¾å…ƒç´ çš„æ•°ç»„ï¼›è€Œ ```size``` ä»£è¡¨çš„æ˜¯ ```elementData``` æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ã€‚æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ```elementData``` æ•°ç»„çš„é•¿åº¦æ˜¯8ï¼Œä½†æ˜¯åªå­˜æ”¾äº†4ä¸ªå…ƒç´ ï¼Œè¿™æ—¶å€™ ```size``` å±æ€§å°±æ˜¯4ã€‚

æˆ‘ä»¬åœ¨ä½¿ç”¨ ```ArrayList``` çš„æ—¶å€™ä¼šç»å¸¸è°ƒç”¨å…¶ ```size()``` æ–¹æ³•ï¼Œè¿”å›çš„å°±æ˜¯ ```elementData``` æ•°ç»„ä¸­ **å·²ä½¿ç”¨** çš„å…ƒç´ çš„æ•°é‡ï¼Œä¹Ÿå³æ˜¯å½“å‰çš„ 4ï¼›å¹¶ä¸”å½“æˆ‘ä»¬æ–°æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œ```size``` æ‰€æŒ‡ä»£çš„ä¹Ÿæ°å·§æ˜¯æ–°å…ƒç´ çš„ä¸‹æ ‡(æ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹)ã€‚

![å›¾ 1-3 ArrayListå±æ€§](https://img-blog.csdnimg.cn/20201114140334980.png?x-oss-process=image)

```java
/**
  * å­˜æ”¾å…ƒç´ çš„æ•°ç»„
  * åœ¨æ–°å¢å…ƒç´ çš„æ—¶å€™ï¼Œå¦‚æœé‡åˆ°æ•°ç»„ä¸å¤Ÿä¼šåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œå¹¶ä¸”å°†åŸæ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°æ•°æ®ï¼›æœ€åå°†è¯¥åº”ç”¨å˜é‡æŒ‡å‘æ–°æ•°ç»„
  */
transient Object[] elementData;

/**
  * æ•°ç»„çš„å¤§å°
  * sizeä»£è¡¨çš„æ˜¯å·²ä½¿ç”¨elementDataçš„å…ƒç´ çš„æ•°é‡ï¼Œä¹Ÿå³æ˜¯size()æ–¹æ³•çš„å¤§å°
  */
private int size;
```

### æ„é€ æ–¹æ³•

```ArrayList``` ä¸€å…±æœ‰3ä¸ªæ„é€ æ–¹æ³•ï¼Œåˆ†åˆ«å¦‚ä¸‹æ‰€ç¤ºã€‚

#### 1. ArrayList(int initialCapacity)

```ArrayList(int initialCapacity)``` æ„é€ æ–¹æ³•ï¼Œæ ¹æ®ä¼ å…¥çš„ ```initialCapacity``` åˆå§‹åŒ–å®¹é‡æ¥åˆ›å»º ```elementData``` æ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä½¿ç”¨ ```ArrayList``` çš„æ—¶å€™ï¼Œé¢„å…ˆçŸ¥é“å…ƒç´ çš„æ•°é‡ï¼Œåº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨è¯¥æ„é€ æ–¹æ³•ï¼Œè¿™æ ·å¯é¿å…æ•°æ®æ‰©å®¹ï¼Œä»è€Œæå‡æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿæ˜¯åˆç†çš„åˆ©ç”¨å†…å­˜ç©ºé—´ï¼ˆä¸€ç‚¹ä¸æµªè´¹~ï¼‰ã€‚

```java
public ArrayList(int initialCapacity) {
    if (initialCapacity > 0) {
        // åˆå§‹åŒ–å®¹é‡å¤§äº0ï¼Œåˆ›å»ºObjectæ•°ç»„
        this.elementData = new Object[initialCapacity];
    } else if (initialCapacity == 0) {
        // åˆå§‹åŒ–å®¹é‡ä¸º 0 æ—¶ï¼Œä½¿ç”¨ EMPTY_ELEMENTDATA å¯¹è±¡
        this.elementData = EMPTY_ELEMENTDATA;
    } else {
        // å‚æ•°å¼‚å¸¸
        throw new IllegalArgumentException("Illegal Capacity: " + initialCapacity);
    }
}
```

è¿™é‡Œéœ€è¦ç•™æ„çš„æ˜¯ï¼šå½“åˆå§‹åŒ–å®¹é‡ ```initialCapcity``` ä¸º 0 çš„æ—¶å€™ï¼Œä½¿ç”¨äº†ä¸€ä¸ª ```EMPTY_ELEMENTDATA``` å¯¹è±¡ï¼ŒæŸ¥çœ‹æºç å¯çŸ¥å…¶å®šä¹‰ï¼š ```private static final Object[] EMPTY_ELEMENTDATA = {}``` æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ‰©å®¹åˆ›å»ºéœ€è¦çš„æ•°ç»„ã€‚

#### 2. ArryaList()

æ— å‚æ„é€ æ–¹æ³•ï¼Œå¹³æ—¶ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœä½ çš„IDEAæœ‰å®‰è£… ```sonarLint``` æ‰«æï¼Œä¼šè¢«æç¤ºï¼šåˆ›å»ºé›†åˆçš„æ—¶å€™è¦æŒ‡å®šåˆå§‹åŒ–å®¹é‡å™¢~

```java
public ArrayList() {
    // å®é™…åˆ›å»ºçš„æ—¶å€™æ˜¯ç©ºæ•°ç»„ï¼Œåœ¨é¦–æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œæ‰ä¼šåˆå§‹åŒ–å®¹é‡ä¸º10çš„æ•°ç»„
    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}
```

æ— å‚æ„é€ æ–¹æ³•ä½¿ç”¨äº† ```DEFAULTCAPACITY_EMPTY_ELEMENTDATA``` å¯¹è±¡ï¼ŒæŸ¥çœ‹æºç å¯çŸ¥å…¶å®šä¹‰ï¼š```private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}``` æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚

ä¼¼ä¹æœ‰æœ‹å‹ä¼šæœ‰ç–‘é—®ï¼šâ€œæˆ‘ä¹‹å‰å­¦ä¹ çš„æ—¶å€™è¢«çŒè¾“çš„æ˜¯ï¼šå½“æœªæŒ‡å®šåˆå§‹åŒ–å¤§å°çš„æ—¶å€™ï¼ŒArrayListé»˜è®¤çš„å¤§å°æ˜¯10å‘€ï¼â€

è¿™å¥è¯ä¸€å®šç¨‹åº¦ä¸Šæ¥è¯´æ˜¯æ²¡é—®é¢˜çš„ï¼Œåªæ˜¯ç¼ºå¤±äº†ä¸€äº›è¡¥å……æè¿°ï¼šå½“æœªæŒ‡å®šåˆå§‹åŒ–å¤§å°çš„æ—¶å€™ï¼ŒArrayListå…ˆæ˜¯åˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºæ•°ç»„ï¼›ä½†åœ¨é¦–æ¬¡æ·»åŠ å…ƒç´ æ—¶ï¼ŒArrayListæ‰ä¼šåˆå§‹åŒ–ä¸ºä¸€ä¸ªå®¹é‡ä¸º10çš„æ•°ç»„ã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯èŠ‚çœå†…å­˜ï¼Œä¸€äº›åœºæ™¯å¯èƒ½åªæ˜¯å•çº¯çš„å®šä¹‰äº†æ•°ç»„å¹¶æ²¡æœ‰çœŸå®çš„ä½¿ç”¨ï¼Œç›´æ¥åˆå§‹åŒ–å®¹é‡ä¸º10çš„æ•°ç»„ä¼šé€ æˆä¸å¿…è¦çš„æµªè´¹ã€‚

ç»†å¿ƒçš„æœ‹å‹å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼šâ€œæ—¢ç„¶éƒ½æ˜¯ç©ºçš„æ•°ç»„ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ ```EMPTY_ELEMENTDATA``` ç©ºæ•°ç»„ï¼›è€Œæ˜¯è¦é‡æ–°å®šä¹‰ä¸€ä¸ªæ–°çš„ç©ºæ•°ç»„ ```DEFAULTCAPACITY_EMPTY_ELEMENTDATA``` å‘¢ï¼Ÿâ€

åˆ«æ€¥ï¼Œæ­£æ‰€è°“ï¼šâ€œå­˜åœ¨å³æ˜¯åˆç†ã€‚â€ è®¾è®¡è€…è¿™ä¹ˆåšè‚¯å®šæœ‰å…¶ç‰¹æ®Šçš„è€ƒè™‘ï¼Œåé¢åœ¨ä»‹ç» ```æ•°ç»„æ‰©å®¹``` çš„æ—¶å€™ä¼šè¯¦ç»†ä»‹ç»ä¸¤è€…çš„ä¸åŒï¼›```DEFAULTCAPACITY_EMPTY_ELEMENTDATA``` çš„é¦–æ¬¡æ‰©å®¹æ˜¯ 10ï¼Œ ```EMPTY_ELEMENTDATA``` çš„é¦–æ¬¡æ‰©å®¹æ˜¯æŒ‰ç…§1.5å€æ‰©å®¹ï¼Œä»0å¼€å§‹ï¼›ä¸¤è€…çš„èµ·ç‚¹ä¸åŒã€‚

#### 3. ArrayList(Collection<? extends E> c)

```ArrayList(Collection<? extends E> c)``` æ„é€ æ–¹æ³•ï¼Œä½¿ç”¨ä¼ å…¥çš„é›†åˆ c ä½œä¸º ArrayListçš„ ```elementData```

```java
public ArrayList(Collection<? extends E> c) {
    // elementæŒ‡å‘c.toArray()  toArray()æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„
    elementData = c.toArray();

    // æ•°ç»„ä¸ç©º
    if ((size = elementData.length) != 0) {
        // å¦‚æœé›†åˆå…ƒç´ çš„ç±»å‹ä¸æ˜¯Object.classç±»å‹ï¼Œ åˆ™æ‹·è´æˆObject.classç±»å‹
        if (elementData.getClass() != Object[].class) {
            elementData = Arrays.copyOf(elementData, size, Object[].class);
        }
    } else {
        // æ•°ç»„ä¸ºç©º ä½¿ç”¨EMPTY_ELEMENTDATA å¯¹è±¡
        this.elementData = EMPTY_ELEMENTDATA;
    }
}
```

å½“```elementData``` æ•°ç»„ä¸ç©ºçš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªç±»å‹è½¬æ¢çš„è¿‡ç¨‹ï¼Œå› ä¸º ```elementData``` æ˜¯ ```Object[]``` ç±»å‹çš„æ•°ç»„ã€‚

### æ–°å¢å…ƒç´ 

æ–°å¢å…ƒç´ çš„æ–¹æ³•ä¸»è¦æœ‰å¦‚ä¸‹4ä¸ªï¼Œåˆ†åˆ«ä¸ºï¼š

- public boolean add(E e) åœ¨æ•°ç»„åé¢ ```é¡ºåº``` æ–°å¢ä¸€ä¸ªå…ƒç´ 

- public void add(int index, E element) åœ¨æŒ‡å®š ```index``` ä½ç½®æ·»åŠ å…ƒç´ 

- public boolean addAll(Collection<? extends E> c) åœ¨æ•°ç»„åé¢ ```é¡ºåº``` æ·»åŠ å¤šä¸ªå…ƒç´ 

- public boolean addAll(int index, Collection<? extends E> c) åœ¨æŒ‡å®š ```index``` ä½ç½®ï¼Œæ·»åŠ å¤šä¸ªå…ƒç´ 

#### public boolean add(E e)

ç»§æ‰¿äº ```AbstractList``` æŠ½è±¡ç±»ï¼Œåœ¨æ•°ç»„åé¢é¡ºåºæ·»åŠ å•ä¸ªå…ƒç´ ã€‚

```java
public boolean add(E e) {
    // sizeæ˜¯å½“å‰æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ï¼Œ +1ä»£è¡¨æ–°å¢ä¸€ä¸ªå…ƒç´ 
    ensureCapacityInternal(size + 1);
    // è¿™ä¸ªæ“ä½œç›¸å½“äº element[size] = e, size++
    elementData[size++] = e;
    // è¿”å›æ·»åŠ æˆåŠŸ
    return true;
}
```

æ–¹æ³•åªæœ‰3å¥ä»£ç ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒç®€å•ï¼›ä¸»è¦å…³æ³¨ä¸€ä¸‹ ```ensureCapacityInternal``` æ–¹æ³•åšäº†ä»€ä¹ˆäº‹æƒ…ï¼›ï¼Œç»è¿‡ä¸Šé¢çš„ä»‹ç»æˆ‘ä»¬çŸ¥é“ï¼ŒArrayListçš„åº•å±‚æ˜¯ä½¿ç”¨æ•°ç»„å®ç°ï¼Œå¹¶ä¸”å…¶ç‰¹æ€§æ˜¯æ”¯æŒåŠ¨æ€æ‰©å®¹çš„ï¼›é‚£ä¹ˆå½“æˆ‘ä»¬æ–°å¢å…ƒç´ çš„æ—¶å€™åº”è¯¥éœ€è¦è€ƒè™‘ï¼š```ç°æœ‰çš„æ•°ç»„å®¹é‡æ˜¯å¦æ”¯æŒæ–°å¢å…ƒç´ ï¼Œå¦‚æœå®¹é‡ä¸æ»¡è¶³ï¼Œåˆ™è¦è€ƒè™‘æ‰©å®¹æ“ä½œ```ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹JDKçš„è®¾è®¡è€…æ˜¯å’‹åšçš„~

**STEP -1** é¦–å…ˆæ˜¯ ```ensureCapacityInternal(int minCapacity)``` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦åŠŸèƒ½ï¼š**ç¡®ä¿æ•°ç»„å†…éƒ¨å®¹é‡è¶³ä»¥æ»¡è¶³æœ¬æ¬¡æ·»åŠ å…ƒç´ æ“ä½œ**ã€‚

æ–¹æ³•å®ç°ä¸Šé¦–å…ˆæ˜¯è°ƒç”¨äº† ```calculateCapacity(Object[] elementData, int minCapacity)``` æ–¹æ³•ï¼Œ**è®¡ç®—æ»¡è¶³æœ¬æ¬¡æ–°å¢æ“ä½œæ‰€éœ€çš„å®¹é‡**ï¼Œç„¶åè°ƒç”¨ ```ensureExplicitCapacity(int minCapacity)``` æ–¹æ³•ï¼Œ**ä¿è¯å®¹é‡è¶³å¤Ÿ**ã€‚

```java
/**
* ç¡®ä¿æ•°ç»„å®¹é‡è¶³å¤Ÿæ·»åŠ å…ƒç´ 
*
* @param minCapacity æœ€å°å®¹é‡
*/
private void ensureCapacityInternal(int minCapacity) {
    // è®¡ç®—å®¹é‡
    int capacity = calculateCapacity(elementData, minCapacity);
    // ç¡®ä¿å®¹é‡è¶³å¤Ÿ -- å¦‚ä¸è¶³å¤Ÿåˆ™è§¦å‘æ‰©å®¹
    ensureExplicitCapacity(capacity);
}

```

**STEP -2** ç„¶åæˆ‘ä»¬æ¥çœ‹çœ‹ ```calculateCapacity(Object[] elementData, int minCapacity)``` æ–¹æ³•æ˜¯å¦‚ä½•è®¡ç®—æœ¬æ¬¡æ–°å¢æ“ä½œæ‰€éœ€çš„å®¹é‡çš„ã€‚

å¦‚æœ ```elementData``` æ˜¯ ```DEFAULTCAPACITY_EMPTY_ELEMENTDATA``` â€”â€”æ²¡æœ‰æŒ‡å®šåˆå§‹åŒ–å®¹é‡æ—¶ï¼›åˆ™ä¼šåˆ¤æ–­æ˜¯æœ€å°å®¹é‡ ```minCapacity``` å’Œ ```DEFAULT_CAPACITY``` çš„å¤§å°ï¼Œå–å¤§å€¼ã€‚

```java
/**
* è®¡ç®—å®¹é‡
* @param elementData å…ƒç´ æ•°ç»„
* @param minCapacity æœ€å°å®¹é‡
* @return int
*/
private static int calculateCapacity(Object[] elementData, int minCapacity) {
    // å¦‚æœæ˜¯DEFAULT_CAPACITY ï¼Œé‚£ä¹ˆå°±ä¼šä»10å¼€
    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
        // DEFAULT_CAPACITY å®šä¹‰ï¼šprivate static final int DEFAULT_CAPACITY = 10;
        return Math.max(DEFAULT_CAPACITY, minCapacity);
    }
    // å¦‚æœä¸æ˜¯åˆ™ç›´æ¥è¿”å›éœ€è¦çš„æœ€å°å®¹é‡
    return minCapacity;
}
```

**STEP -3** ```ensureExplicitCapacity``` å¦‚ä½•ç¡®ä¿æ•°ç»„å®¹é‡è¶³å¤Ÿæœ¬æ¬¡æ–°å¢æ“ä½œçš„ï¼Ÿ ç”±ä»£ç å¯ä»¥çœ‹å‡ºï¼Œå½“æ‰€éœ€çš„æœ€å°å®¹é‡```minCapacity``` å¤§äº ```elementData.length``` æ•°ç»„é•¿åº¦çš„æ—¶å€™ï¼Œåˆ™è§¦å‘ ```grow()``` æ‰§è¡Œæ‰©å®¹ã€‚

```java

/**
  * ç¡®ä¿æ•°ç»„å‰©ä½™å®¹é‡è¶³å¤Ÿ
  *
  * @param minCapacity æœ€å°å®¹é‡
  */
private void ensureExplicitCapacity(int minCapacity) {
    // åœ¨çˆ¶ç±» AbstractListä¸­å®šä¹‰äº† ç”¨ä»¥è®°å½•æ•°ç»„ä¿®æ”¹çš„æ¬¡æ•°(æ³¨æ„æ˜¯æ¬¡æ•°)
    modCount++;

    // minCapacityä»£è¡¨çš„æ˜¯æœ¬æ¬¡ï¼ˆæ–°å¢ï¼‰æ“ä½œæ‰€éœ€è¦çš„æœ€å°å®¹é‡ï¼Œ elementData.lengthä»£è¡¨çš„æ˜¯å½“å‰å…ƒç´ æ•°ç»„çš„é•¿åº¦
    // å¯èƒ½å†™æˆ minCapacity > elementData.length æ›´å¥½ç†è§£
    if (minCapacity - elementData.length > 0) {
        // æ‰©å®¹å¯æŒ‡å®šæœ€å°çš„å®¹é‡ï¼ˆæ»¡è¶³å½“å‰éœ€æ±‚ï¼‰
        grow(minCapacity);
    }
}

```

**STEP -4** çœ‹çœ‹```grow```æ˜¯å’‹æ‰©å®¹çš„~

```java
/**
  * æ‰©å®¹
  * æ—§å®¹é‡ç»è¿‡è¿ç®—æ‰©å±•ä¸º1.5åä¸æœ€å°å®¹é‡minCapacityè¿›è¡Œæ¯”è¾ƒ
  * å¦‚æœå¤§äºåˆ™é‡‡ç”¨æ—§å®¹é‡æ‰©å±•1.5å€åçš„å¤§å°ï¼Œå¦åˆ™é‡‡ç”¨æœ€å°å®¹é‡minCapacity
  * @param minCapacity æ–°å¢æ“ä½œæ‰€éœ€æœ€å°å®¹é‡
  */
private void grow(int minCapacity) {
    // æ—§å®¹é‡å¤§å° elementDataæ•°ç»„çš„é•¿åº¦
    int oldCapacity = elementData.length;
    // æ–°å®¹é‡å¤§å° == æ—§ + æ—§çš„ä½è¿ç®— ï¼ˆå‘å³ç§»åŠ¨1ä½ï¼‰   å¤§è‡´ä¸Šæ˜¯åŸå¤§å°çš„1.5å€
    int newCapacity = oldCapacity + (oldCapacity >> 1);
    // å¦‚æœè®¡ç®—å‡ºæ¥çš„æ–°å®¹é‡å°äº æŒ‡å®šçš„æœ€å°å®¹é‡ï¼Œåˆ™åˆ›å»ºæŒ‡å®šçš„æœ€å°å®¹é‡å¤§å°çš„æ–°æ•°ç»„
    // å¯ç†è§£ä¸º newCapacity < minCapacity ä¸çŸ¥é“ä¸ºå•¥ä¼šå–œæ¬¢å†™æˆå‡æ³•çš„å½¢å¼ã€‚ã€‚ã€‚
    if (newCapacity - minCapacity < 0) {
        newCapacity = minCapacity;
    }
    // å¦‚æœæ–°å®¹é‡å¤§äºæœ€å¤§å€¼ï¼ˆä¼šå‡ºç°å†…å­˜ä¸è¶³çš„æƒ…å†µï¼‰
    // private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8
    if (newCapacity - MAX_ARRAY_SIZE > 0) {
        // hugeCapicatyæ–¹æ³•ç”¨ä»¥å½“ newCapacityè¶…è¿‡æŒ‡å®šèŒƒå›´çš„æ—¶å€™ï¼Œç¡®ä¿åˆ›å»ºçš„æ•°ç»„ä¸ä¼šæº¢å‡º
        newCapacity = hugeCapacity(minCapacity);
    }
    // æ•°ç»„æ‹·è´ï¼Œå°†åŸæœ‰çš„æ•°æ®æ¬åˆ°æ–°çš„æ•°ç»„ä¸Š
    elementData = Arrays.copyOf(elementData, newCapacity);
}

```

ç»è¿‡ä¸€è½®è®²è§£ï¼Œæˆ‘ä»¬å¤§ä½“ä¸ŠçŸ¥é“```ArrayList``` æ˜¯å¦‚ä½•æ–°å¢å…ƒç´ çš„ï¼Œé¦–å…ˆè®¡ç®—å‡ºæ–°å¢å…ƒç´ æ‰€éœ€è¦çš„æœ€å°å®¹é‡ï¼Œç„¶ååˆ¤æ–­å½“å‰ ```elementData``` æ•°ç»„æ˜¯å¦æ”¯æŒæœ¬æ¬¡æ–°å¢æ“ä½œï¼ˆå®¹é‡æ˜¯å¦è¶³å¤Ÿï¼‰ï¼Œå½“å®¹é‡ä¸è¶³çš„æ—¶å€™åˆ™è§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œå°†åŸæœ‰æ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°æ–°æ•°ç»„ä¸Šï¼Œç„¶åå¾€åè¿½åŠ æ–°çš„å…ƒç´ ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹çœ‹å‰©ä¸‹çš„å‡ ä¸ªæ–°å¢å…ƒç´ çš„æ–¹æ³•

#### public void add(int index, E element)

```public void add(int index, E element)``` æ–¹æ³•ç»§æ‰¿äº ```AbstractList``` æŠ½è±¡ç±»ï¼Œåœ¨æŒ‡å®š ```index``` ä½ç½®æ–°å¢å…ƒç´  ```element```ã€‚

æºç å¦‚ä¸‹ï¼š

```java
/**
  * åœ¨æŒ‡å®šindexä½ç½®æ·»åŠ å…ƒç´ element
  * @param index
  * @param element
  */
public void add(int index, E element) {
    // å‚æ•°åˆæ³•æ€§æ ¡éªŒ
    rangeCheckForAdd(index);
    // ç¡®ä¿å®¹é‡å¯ç”¨---å¦‚æœä¸å¯ç”¨ä¼šè§¦å‘æ‰©å®¹æœºåˆ¶
    ensureCapacityInternal(size + 1);  // Increments modCount!!
    // æ•°ç»„indexä½ç½®åçš„å…ƒç´ éƒ½å¾€åç§»1ä½
    System.arraycopy(elementData, index, elementData, index + 1, size - index);
    // æŒ‡å®šä½ç½®æ·»åŠ elementå…ƒç´ 
    elementData[index] = element;
    // size + 1
    size++;
}

/**
  * å‚æ•°åˆæ³•æ€§æ ¡éªŒ
  * index > size ä¸å…è®¸ï¼Œåªèƒ½æ˜¯å¯¹å·²å­˜åœ¨çš„indexè¿›è¡Œæ·»åŠ 
  */
private void rangeCheckForAdd(int index) {
    if (index > size || index < 0) {
        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
    }
}
```

æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œé¦–å…ˆæ˜¯å‚æ•°çš„åˆæ³•æ€§æ£€æŸ¥ï¼Œç„¶åå°±æ˜¯ä¸Šé¢ä»‹ç»çš„ ```ensureCapacityInternal``` æ–¹æ³•ï¼Œç”¨ä»¥ç¡®ä¿æ•°ç»„å®¹é‡æ»¡è¶³æœ¬æ¬¡æ–°å¢æ“ä½œï¼›éœ€è¦é¢å¤–è®²è§£çš„å¯èƒ½æ˜¯ ```System.arraycopy()``` æ–¹æ³•ã€‚

```System.arraycopy(Object src, int scrPos, Object desc, int destPos, int length)``` æ–¹æ³•ï¼Œç”¨äºå°†æŒ‡å®šæºæ•°ç»„ä¸­çš„å…ƒç´ ä»æŒ‡å®šä½ç½®åˆ°ç›®æ ‡æ•°ç»„çš„æŒ‡å®šä½ç½®

- srcï¼šæºæ•°ç»„

- srcPosï¼šæºæ•°ç»„å¤åˆ¶çš„èµ·å§‹ä½ç½®

- descï¼šç›®æ ‡æ•°ç»„

- descPosï¼šç›®æ ‡æ•°ç»„å¡«å……æ•°æ®çš„èµ·å§‹ä½ç½®

- lengthï¼šè¦å¤åˆ¶æºæ•°ç»„çš„å…ƒç´ æ•°é‡

ä¾‹å¦‚ï¼š

```java
// åŸæ•°ç»„ï¼šint[] arr1 = {1,2,3,4,5,6,7,8,9,0};
// ç›®æ ‡æ•°ç»„ï¼šint[] arr2 = new int[4];
// æ“ä½œï¼šå°†åŸæ•°ç»„ç¬¬äºŒä¸ªä½ç½®ä»¥åçš„4ä¸ªæ•°æ®copyåˆ°ç›®æ ‡æ•°ç»„
System.arrayCopy(arr1, 1, arr2, 0, 4);
```

#### public boolean addAll(Collection<? extends E> c)

```public boolean addAll(Collection<? extends E> c)``` ç»§æ‰¿äº ```AbstractCollection``` æŠ½è±¡ç±»ï¼Œåœ¨æ•°ç»„åé¢ ```é¡ºåº``` æ·»åŠ å¤šä¸ªå…ƒç´ ã€‚å½“æˆ‘ä»¬ç¡®å®šä¼šæ·»åŠ å¤šä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå»ºè®®ä½¿ç”¨è¯¥æ–¹æ³•è€Œä¸æ˜¯å•ä¸ªå…ƒç´ é€ä¸ªçš„æ·»åŠ ï¼Œé¿å…å¯èƒ½å¤šæ¬¡æ‰©å®¹é€ æˆçš„æ€§èƒ½ä¸‹é™ã€‚

æºç å¦‚ä¸‹ï¼š

```java
/**
  * åœ¨æ•°ç»„åé¢é¡ºåºæ·»åŠ å¤šä¸ªå…ƒç´ 
  * @param c é›†åˆc
  * @return boolean
  */
public boolean addAll(Collection<? extends E> c) {
    Object[] a = c.toArray();
    int numNew = a.length;
    // ç¡®ä¿æ•°ç»„å®¹é‡è¶³å¤Ÿæœ¬æ¬¡æ·»åŠ å…ƒç´ æ“ä½œï¼Œå’Œæ·»åŠ å•ä¸ªå…ƒç´ çš„ä¸€æ ·ï¼›åªä¸è¿‡ sizeä¸å†æ˜¯ + 1 è€Œæ˜¯ + c.length
    ensureCapacityInternal(size + numNew);  // Increments modCount
    // æ‹·è´æ•°ç»„
    System.arraycopy(a, 0, elementData, size, numNew);
    size += numNew;
    return numNew != 0;
}
```

ä»£ç ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå’Œ```add(E e)``` å¾ˆç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯å°†æ·»åŠ 1ä¸ªå…ƒç´ å˜æˆäº†æ·»åŠ å¤šä¸ªå…ƒç´ ç½¢äº†~

#### public boolean addAll(int index, Collection<? extends E> c)

```public boolean addAll(int index, Collection<? extends E> c)``` æ–¹æ³•ç»§æ‰¿äº ```AbstractList``` æŠ½è±¡ç±»ï¼Œç”¨ä»¥åœ¨æŒ‡å®š ```index``` ä½ç½®æ·»åŠ å¤šä¸ªå…ƒç´ 

```java
/**
  * åœ¨æŒ‡å®šindexä½ç½®æ·»åŠ å¤šä¸ªå…ƒç´ c
  * @param index
  * @param c
  * @return boolean
  */
public boolean addAll(int index, Collection<? extends E> c) {
    // index å‚æ•°åˆæ³•æ€§æ£€æŸ¥
    rangeCheckForAdd(index);

    Object[] a = c.toArray();
    int numNew = a.length;
    // ç¡®ä¿æ•°æ®å®¹é‡æ»¡è¶³æœ¬æ¬¡æ·»åŠ å…ƒç´ æ“ä½œ ---ä¸æ»¡è¶³åˆ™æ‰©å®¹
    ensureCapacityInternal(size + numNew);  // Increments modCount
    // åŸæœ‰indexåçš„å…ƒç´ å¾€åç§»åŠ¨ï¼Œç§»åŠ¨numNewä¸ªä½ç½®
    int numMoved = size - index;
    if (numMoved > 0)
        System.arraycopy(elementData, index, elementData, index + numNew, numMoved);
    // ç©ºé—²å‡ºæ¥çš„ä½ç½®ï¼Œå¡«å……éœ€è¦æ·»åŠ çš„å…ƒç´ 
    System.arraycopy(a, 0, elementData, index, numNew);
    size += numNew;
    return numNew != 0;
}

```

ä»£ç ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œé¦–å…ˆè¿˜æ˜¯å…ˆè¿›è¡Œå®¹é‡å¯è¾¾æ“ä½œï¼Œè®©æ•°ç»„çš„å®¹é‡æ»¡è¶³æœ¬æ¬¡çš„æ‰©å®¹æ“ä½œï¼›å…¶æ¬¡æ˜¯å› ä¸ºéœ€è¦åœ¨ ```index``` ä½ç½®æ–°å¢å¤šä¸ªå…ƒç´ ï¼Œåˆ™åŸæ¥åœ¨ ```index``` ä½ç½®åçš„çš„å…ƒç´ éƒ½åº”è¯¥å¾€åé¡ºå»¶ ```c.length``` ä¸ªä½ç½®ã€‚

### åˆ é™¤å…ƒç´ 

åˆ é™¤å…ƒç´ çš„æ–¹æ³•ä¸»è¦æœ‰4ä¸ªï¼Œåˆ†åˆ«ä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼š

- ```public E remove(int index)``` ç§»é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥ä½ç½®çš„åŸå…ƒç´ ã€‚

- ```public boolean remove(Object o)``` ç§»é™¤é¦–ä¸ªä¸º o çš„å…ƒç´ ï¼Œå¹¶è¿”å›æ˜¯å¦ç§»é™¤æˆåŠŸã€‚

- ```protected void removeRange(int fromIndex, int toIndex)``` æ‰¹é‡ç§»é™¤ ```[fromIndex, toIndex)```å†…çš„å¤šä¸ªå…ƒç´ ï¼Œè¿™é‡Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š ```toIndex``` ä¸åŒ…æ‹¬çš„å™¢ã€‚

- ```public boolean removeAll(Collection<?> c)``` æ‰¹é‡ç§»é™¤æŒ‡å®šçš„å¤šä¸ªå…ƒç´ ã€‚

#### public E remove(int index)

```public E remove(int index)``` ç»§æ‰¿äº ```AbstractList``` æŠ½è±¡ç±»ï¼Œåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥ä½ç½®ä¸Šçš„åŸå…ƒç´ ã€‚

æºç å¦‚ä¸‹ï¼š

```java
/**
  * åˆ é™¤æŒ‡å®šä½ç½®indexçš„å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ 
  * @param index
  * @return E
  */
public E remove(int index) {
    // index åˆæ³•æ€§æ ¡éªŒï¼Œä¸åˆæ³•åˆ™æŠ›å‡ºç›¸å…³å¼‚å¸¸
    rangeCheck(index);
    // ä¿®æ”¹æ•°ç»„çš„æ¬¡æ•° + 1 è™½ç„¶ä¸çŸ¥é“è¿™ä¸ªæ˜¯åšå•¥å­ç©çš„...
    modCount++;
    // è·å–indexä¸‹æ ‡å¯¹åº”çš„valueï¼ŒelementDataæ–¹æ³•å…¶å®å°±æ˜¯ return (E) elementData[index]
    E oldValue = elementData(index);

    // æ¯åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼Œéƒ½éœ€è¦å¯¹åŸæœ‰çš„æ•°ç»„è¿›è¡Œç§»åŠ¨ï¼Œæ‰€ä»¥ä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºArrayListå¹¶ä¸æ˜¯ç‰¹åˆ«é€‚åˆäºåˆ é™¤æ“ä½œæ¯”è¾ƒå¤šçš„åœºæ™¯~
    // éœ€è¦ç§»åŠ¨çš„å…ƒç´ çš„æ•°é‡
    int numMoved = size - index - 1;
    if (numMoved > 0)
        System.arraycopy(elementData, index + 1, elementData, index, numMoved);
    // æ•°ç»„çš„æœ€åä¸€ä¸ªä½ç½®è®¾ç½®ä¸ºnull  å¸®åŠ©GC
    // è¿™ä¸ªæ“ä½œç›¸å½“äº elementData[size] = null;  size --;
    // ä¸å»ºè®®å¼€å‘ä¸­è¿™ä¹ˆå†™ï¼Œå†™è¿™æ ·æ˜¯æƒ³å‘è°å‘¢ emmm ä»£ç è¿˜æ˜¯è¦ä»¥å¯è¯»æ€§ä¸ºå‡†
    elementData[--size] = null;

    return oldValue;
}

private void rangeCheck(int index) {
    // index åˆæ³•æ€§æ ¡éªŒ
    if (index >= size) {
        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
    }
}
```

ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•æ˜“è¯»çš„ï¼Œå‡¡æ˜¯æ¶‰åŠåˆ° ```index``` çš„é¦–å…ˆéƒ½æ˜¯ä¸‡å¹´ä¸å˜çš„å‚æ•°åˆæ³•æ€§æ£€æŸ¥ï¼Œç„¶åå†è·å–```index```å¯¹åº”ä¸‹æ ‡çš„å…ƒç´ ï¼›å†å¯¹```index```ä½ç½®åçš„å…ƒç´ å¾€å‰ç§»åŠ¨ï¼Œæœ€ç»ˆè¿”å›è¢«åˆ é™¤å…ƒç´ å€¼ã€‚

éœ€è¦å…³æ³¨çš„æ˜¯ï¼š```ArrayList``` çš„åˆ é™¤æ“ä½œï¼Œéƒ½ä¼šä¼´éšç€æ•°ç»„å…ƒç´ çš„ç§»åŠ¨æ“ä½œï¼ˆé™¤éä½ æ¯æ¬¡éƒ½åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå°±å½“æˆ‘æ²¡è¯´ï¼‰ï¼Œè€Œè¿™ç§ç§»åŠ¨æ“ä½œæ˜¯æœ‰æ€§èƒ½ä¸Šçš„æ¶ˆè€—çš„ï¼›å› æ­¤ä¹Ÿå¯ä»¥çœ‹å‡º ```ArrayList``` å¹¶ä¸æ˜¯é‚£ä¹ˆé€‚åˆäºåˆ é™¤ç‰¹åˆ«é¢‘ç¹çš„åœºæ™¯ã€‚

#### public boolean remove(Object o)

```public boolean remove(Object o)``` æ–¹æ³•ç»§æ‰¿äº ```AbstractCollection``` æŠ½è±¡ç±»ï¼Œç§»é™¤é¦–ä¸ªä¸º o çš„å…ƒç´ ï¼Œè¿”å›æ˜¯å¦ç§»é™¤æˆåŠŸã€‚

æºç å¦‚ä¸‹:

```java
/**
* ç§»é™¤é¦–ä¸ªä¸º o çš„å…ƒç´ 
* @param o
* @return  boolean
*/
public boolean remove(Object o) {
    if (o == null) {
        // ä»å¤´éå†elementDataæ•°ç»„ æ‰¾åˆ°ç¬¬ä¸€ä¸ªoå…ƒç´ çš„indexï¼Œè°ƒç”¨fastRemoveæ–¹æ³•è¿›è¡Œåˆ é™¤
        for (int index = 0; index < size; index++)
            if (elementData[index] == null) {
                // çœŸå®æ‰§è¡Œåˆ é™¤æ“ä½œçš„æ–¹æ³•Â·
                fastRemove(index);
                return true;
            }
    } else {
        for (int index = 0; index < size; index++)
            if (o.equals(elementData[index])) {
                fastRemove(index);
                return true;
            }
    }
    return false;
}

/**
* å­˜ç²¹çš„ç§»é™¤å…ƒç´ çš„æ“ä½œï¼Œä¸åšå‚æ•°æ ¡éªŒï¼ˆç”±ä¸Šå±‚è°ƒç”¨è€…è‡ªå·±åšå‚æ•°åˆæ³•æ€§æ£€æŸ¥ï¼‰
* æ“ä½œæ¬¡æ•° + 1
* indexåçš„å…ƒç´ å‘å‰ç§»åŠ¨
*/
private void fastRemove(int index) {
    // æ•°ç»„æ“ä½œæ¬¡æ•° + 1
    modCount++;
    // éœ€è¦è¿ç§»çš„å…ƒç´ çš„æ•°é‡
    int numMoved = size - index - 1;
    if (numMoved > 0) {
        // å…ƒç´ å‰ç§»ï¼Œå¡«å……indexä½
        System.arraycopy(elementData, index+1, elementData, index, numMoved);
    }
    // æ¸…ç†æœ€åä¸€ä¸ªä½ç½® è®¾ç½®ä¸ºnull æ–¹ä¾¿åç»­çš„GC
    // ç›¸å½“äº elementData[size] = null; size --;
    elementData[--size] = null;
}
```

æ–¹æ³•ä¸éš¾ï¼Œçœ‹çœ‹æ˜¯æ€ä¹ˆå®ç°çš„ï¼šé¦–å…ˆæ˜¯ä»å¤´éå†```elementData```æ•°ç»„ï¼Œæ‰¾åˆ° **ç¬¬ä¸€ä¸ª** åŒ¹é…çš„ o å…ƒç´ ï¼Œè¿”å›å…¶ä¸‹æ ‡ï¼Œè°ƒç”¨ ```fastRemove(int index)``` æ–¹æ³•ï¼Œè¿›è¡Œåˆ é™¤æ“ä½œã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œ```ArrayList``` æ˜¯æ”¯æŒæ·»åŠ ä¸º ```null``` çš„å…ƒç´ çš„ã€‚

#### protected void removeRange(int fromIndex, int toIndex)

```protected void removeRange(int fromIndex, int toIndex)``` ç»§æ‰¿äº ```AbstractList``` æŠ½è±¡ç±»ï¼Œæ‰¹é‡ç§»é™¤ ```[fromIndex, toIndex)``` ä½ç½®çš„å¤šä¸ªå…ƒç´ ï¼Œæ³¨æ„ä¸åŒ…æ‹¬ ```toIndex```ä½ç½®çš„å…ƒç´ ã€‚

æºç å¦‚ä¸‹ï¼š

```java
 /**
   * ç§»é™¤ [fromIndex, toIndex) èŒƒå›´å†…çš„å…ƒç´ 
   * @param fromIndex  åŒ…æ‹¬
   * @param toIndex ä¸åŒ…æ‹¬
   */
protected void removeRange(int fromIndex, int toIndex) {
    // æ“ä½œæ¬¡æ•° + 1
    modCount++;

    // toIndexåé¢çš„å…ƒç´ éƒ½éœ€è¦è¢«ç§»åŠ¨åˆ°å‰é¢
    int numMoved = size - toIndex;
    // å› æ­¤å¯ä»¥çœ‹åˆ°ä¸ºå•¥å­å³è¾¹æ˜¯)ï¼Œå› ä¸ºå®ƒå¹¶æ²¡æœ‰ + 1
    System.arraycopy(elementData, toIndex, elementData, fromIndex, numMoved);

    // è®¡ç®—æ–°çš„æ•°ç»„é•¿åº¦
    int newSize = size - (toIndex - fromIndex);
    // æ•°ç»„å¾€å‰ç§»åŠ¨åï¼Œåé¢æ‰€æœ‰ç©ºé—²çš„ä½ç½®éƒ½è®¾ä¸ºnull
    for (int i = newSize; i < size; i++) {
        elementData[i] = null;
    }
    // æ›´æ–°æ–°çš„é•¿åº¦
    size = newSize;
}
```

ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä»æºç ä¸­çœ‹å‡ºä¸ºä»€ä¹ˆå³è¾¹ ```toIndex``` å¹¶æ²¡æœ‰è¢«åŒ…å«ï¼Œå› ä¸º ```arraycopy``` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä» ```toIndex``` å¼€å§‹ï¼Œå¹¶æ²¡æœ‰ + 1ï¼›åé¢çš„ä»£ç æ¯”è¾ƒç®€å•å¯ç›´æ¥çœ‹æ³¨é‡Šã€‚

#### public boolean removeAll(Collection<?> c)

```public boolean removeAll(Collection<?> c)``` æ–¹æ³•ï¼Œç»§æ‰¿äº```AbstractCollection``` æŠ½è±¡ç±»ï¼Œæ‰¹é‡åˆ é™¤æŒ‡å®šçš„å¤šä¸ªå…ƒç´ ã€‚

æºç å¦‚ä¸‹ï¼š

```java
/**
  * æ‰¹é‡åˆ é™¤æŒ‡å®šçš„å¤šä¸ªå…ƒç´ 
  * @param c
  * @return boolean
  */
@Override
public boolean removeAll(Collection<?> c) {
    // é›†åˆcåˆ¤æ–­æ“ä½œ
    Objects.requireNonNull(c);
    // è°ƒç”¨çœŸå®çš„åˆ é™¤æ–¹æ³•ï¼ˆè¯¥æ–¹æ³•ä¸retainAll å…¶å®å…±ç”¨ä¸€ä¸ªé€»è¾‘ï¼Œå…³é”®åœ¨äºå‚æ•°2ï¼šcomplementçš„å–å€¼æ˜¯falseè¿˜æ˜¯trueï¼‰
    return batchRemove(c, false);
}

/**
  * çœŸå®æ‰§è¡Œåˆ é™¤çš„æ–¹æ³•
  * æ‰¹é‡ç§»é™¤æ“ä½œ
  * @param complement è¡¥å……ä¿¡æ¯ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨removeAllå’ŒretainAllä¸­éƒ½è¢«ä½¿ç”¨åˆ°ï¼Œè¯¥å­—æ®µç”¨ä»¥ç¡®è®¤æ˜¯removeè¿˜æ˜¯retain
  * å½“complementä¸ºfalseçš„æ—¶å€™ï¼Œç”¨ä»¥åˆ é™¤ å½“complementä¸ºtrueçš„æ—¶å€™ï¼Œç”¨ä»¥ä¿ç•™
  */
private boolean batchRemove(Collection<?> c, boolean complement) {
    // å®šä¹‰ä¸€ä¸ªå¼•ç”¨å˜é‡æŒ‡å‘elementData
    final Object[] elementData = this.elementData;
    // ræ˜¯ç®€å•çš„éå†å‚æ•°ï¼Œ wæ˜¯é‡æ–°å¡«å……æ•°ç»„å…ƒç´ çš„indexå‚æ•°
    int r = 0, w = 0;
    // æ˜¯å¦è¢«ä¿®æ”¹
    boolean modified = false;
    try {
        for (; r < size; r++) {
            // removeAllæ˜¯false retainAllçš„æ˜¯true
            // å‡è®¾åŸä¸º 1 2 3 4 5 6ï¼Œ æƒ³åˆ é™¤ 1 3 5ï¼Œ é‚£ä¹ˆå½“c.contains(elementData[r]) == trueçš„æ—¶å€™ï¼Œæˆ‘ä¸å¸Œæœ›å®ƒè¢«èµ‹å€¼åˆ°æ–°çš„æ•°ç»„ä¸­çš„ï¼Œ
            // æ‰€ä»¥ä¼šè®¾ç½®æˆfalseï¼› å¹¶ä¸”ä»–ä»¬çš„ç›¸å¯¹ä½ç½®æ˜¯ä¸å˜çš„
            if (c.contains(elementData[r]) == complement) {
                // ç›¸å½“äºæ˜¯æŠŠæ–°çš„å…ƒç´ ä»å¤´å¼€å§‹æ”¾ç½®
                // elementData[w] = elementData[r];  w++;
                elementData[w++] = elementData[r];
            }
        }
    } finally {
        // ä»€ä¹ˆæ—¶å€™ä¼šè¿›å…¥åˆ°è¿™é‡Œå‘¢ï¼Ÿ å¤§æ¦‚æ˜¯tryçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å¼‚å¸¸
        if (r != size) {
            System.arraycopy(elementData, r, elementData, w, size - r);
            w += size - r;
        }
        // wä¸sizeä¸ç›¸ç­‰ï¼Œè¯´æ˜æ˜¯removeAll
        if (w != size) {
            // æ¸…ç©ºæ•°ç»„åé¢çš„æ— ç”¨indexçš„å…ƒç´  å¸®åŠ©GC
            for (int i = w; i < size; i++) {
                elementData[i] = null;
            }
            modCount += size - w;
            size = w;
            modified = true;
        }
    }
    return modified;
}

```

ä»£ç çœ‹èµ·æ¥å¯èƒ½ä¼šæœ‰ç‚¹é•¿ï¼Œä½†æ˜¯é€»è¾‘è¿˜æ˜¯æ¯”è¾ƒçš„æ¸…æ™°çš„ï¼Œå„ä½æœ‹å‹çœ‹çœ‹ä»£ç æ³¨é‡Šåº”è¯¥é—®é¢˜ä¸å¤§~~

åˆ é™¤æ“ä½œçš„æºç è®²è§£å°±åˆ°è¿™é‡Œï¼Œæ€»ä½“æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒçš„ç®€å•çš„ï¼›ä¸»è¦çš„æµç¨‹å¤§ä½“ä¸Šæ˜¯ï¼š

1. æ‰¾åˆ°éœ€è¦åˆ é™¤çš„å…ƒç´ æ‰€åœ¨çš„ä¸‹æ ‡ ```index```ï¼Œæ‰§è¡Œåˆ é™¤æ“ä½œã€‚

2. ä¸‹æ ‡ ```index``` åçš„å…ƒç´ å‘å‰ç§»åŠ¨ï¼Œå¹¶ä¸”æ›´æ–° ```size``` ç­‰å˜é‡ã€‚

### æŸ¥æ‰¾å…ƒç´ 

```public int indexOf(Object o)``` æ–¹æ³•ï¼ŒæŸ¥æ‰¾ **é¦–ä¸ª** ä¸ºæŒ‡å®šå…ƒç´  o çš„ä½ç½®ï¼Œæºç å¦‚ä¸‹ï¼š

```java
/**
  * æŸ¥æ‰¾é¦–ä¸ªä¸ºæŒ‡å®šå…ƒç´  o çš„ä½ç½®
  * @param o è¢«æŸ¥æ‰¾å…ƒç´ 
  * @return int å¦‚æœå­˜åœ¨åˆ™è¿”å›å¯¹åº”index ä¸å­˜åœ¨è¿”å›-1
  */
@Override
public int indexOf(Object o) {
    // ä»è¿™é‡Œæˆ‘ä»¬å…¶å®ä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒArrayListæ˜¯æ”¯æŒå­˜å‚¨nullå€¼çš„
    if (o == null) {
        for (int i = 0; i < size; i++) {
            if (elementData[i]==null) {
                return i;
            }
        }
    } else {
        for (int i = 0; i < size; i++) {
            if (o.equals(elementData[i])) {
                return i;
            }
        }
    }
    // ä¸å­˜åœ¨åˆ™è¿”å› -1
    return -1;
}

```

ä»£ç ä¸éš¾æ²¡å•¥å¥½è¯´çš„ï¼Œå•çº¯çš„éå†æ•°ç»„åŒ¹é…å…ƒç´ è¿”å›ä¸‹æ ‡ ```index```ï¼Œéœ€è¦é¢å¤–æ³¨æ„çš„æ˜¯ï¼šæˆ‘ä»¬å¯ä»¥çœ‹å‡º ```ArrayList``` æ˜¯æ”¯æŒå­˜å‚¨ ```null``` å€¼çš„ã€‚

å¯èƒ½è¿˜æœ‰å°ä¼™ä¼´ä¼šç”¨åˆ° ```lastIndexOf(Object o)``` æ–¹æ³•ï¼Œç”¨ä»¥æŸ¥æ‰¾æœ€åä¸€ä¸ªä¸ºæŒ‡å®šå…ƒç´ çš„ä½ç½®ï¼›ä»£ç å…¶å®ä¹Ÿå¾ˆç›¸ä¼¼ï¼Œåªä¸è¿‡æ˜¯ä»æ•°ç»„çš„åé¢å¼€å§‹éå†ç½¢äº†~

```java
/**
  * æŸ¥æ‰¾æœ€åä¸€ä¸ªä¸ºæŒ‡å®šå…ƒç´ çš„ä¸‹æ ‡ä½ç½®
  * @param o
  * @return int ä¸‹æ ‡ä½ç½®ï¼Œä¸å­˜åœ¨åˆ™è¿”å›-1
  */
@Override
public int lastIndexOf(Object o) {
    // æœ€åä¸€æ¬¡å‡ºç°å…ƒç´ oçš„ä¸‹æ ‡ï¼Œåšæ³•å¾ˆç®€å•ï¼Œåè¿‡æ¥éå†ç¬¬ä¸€ä¸ªå‡ºç°å°±æ˜¯äº†~~
    if (o == null) {
        for (int i = size-1; i >= 0; i--) {
            if (elementData[i]==null) {
                return i;
            }
        }
    } else {
        for (int i = size-1; i >= 0; i--) {
            if (o.equals(elementData[i])) {
                return i;
            }
        }
    }
    // ä¸å­˜åœ¨åˆ™è¿”å› -1
    return -1;
}
```

### è½¬æ¢æˆæ•°ç»„

è½¬æ¢ä¸ºæ•°ç»„çš„æ–¹æ³•æœ‰2ä¸ªï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š

- ```public Object[] toArray()``` å°† ```ArrayList``` è½¬æ¢ä¸º ```Object[]``` æ•°ç»„

- ```public <T> T[] toArray(T[] a)``` å°† ```ArrayList``` è½¬æ¢ä¸ºæŒ‡å®š ```T``` æ³›å‹çš„æ•°ç»„

ä¸¤è€…çš„æºç å¦‚ä¸‹ï¼š

```java
/**
  * å°†ArrayListè½¬æ¢æˆObjectç±»å‹æ•°ç»„
  * @return Object[]
  */
@Override
public Object[] toArray() {
    // è¿”å›çš„æ˜¯Object[] ç±»å‹ï¼Œéœ€è¦æ³¨æ„ï¼›è½¬æ¢æˆæ•°ç»„å°±ç›¸å½“äºæ˜¯å°† ArrayListçš„åº•å±‚elementDataæš´éœ²å‡ºå»è€Œå·²
    return Arrays.copyOf(elementData, size);
}


public static <T> T[] copyOf(T[] original, int newLength) {
    return (T[]) copyOf(original, newLength, original.getClass());
}
```

æˆ‘ä»¬åœ¨è°ƒç”¨ ```toArray()``` çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°å¼‚å¸¸ ```java.lang.ClassCastException```ï¼›è¿™æ˜¯å› ä¸º ```toArray()``` æ–¹æ³•è¿”å›çš„ç±»å‹æ˜¯ ```Obejct[]```ï¼Œå¦‚æœæˆ‘ä»¬å°†å…¶è½¬æ¢æˆå…¶ä»–ç±»å‹ï¼Œå¯èƒ½å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ è¿™æ˜¯å› ä¸º **Javaå¹¶ä¸æ”¯æŒå‘ä¸‹è½¬å‹** ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬éœ€è¦å°† ```ArrayList``` è½¬æ¢æˆæ•°ç»„å¹¶ä¸”æŒ‡å®šç±»å‹çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿ç”¨ä¸‹é¢çš„è¿™ä¸ªæ–¹æ³•ã€‚

çœŸå®çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å…¶å®æ›´å¸Œæœ›è¿”å›æŒ‡å®šæ³›å‹çš„æ•°ç»„ï¼Œæ‰€ä»¥æ¥ç…ç… ```public <T> T[] toArray(T[] a)``` æ˜¯å’‹åšçš„ï¼Œå¹¶ä¸”çœ‹çœ‹æœ‰å“ªäº›åœ°æ–¹éœ€è¦ç•™æ„çš„ã€‚

```java
/**
  * å°†ArrayListè½¬æ¢æˆæŒ‡å®šæ³›å‹çš„æ•°ç»„
  * @param a
  * @return T[]
  */
@Override
@SuppressWarnings("unchecked")
public <T> T[] toArray(T[] a) {
    // ã€Š1ã€‹.å¦‚æœä¼ å…¥çš„æ•°ç»„å°äº size çš„å¤§å°ï¼Œç›´æ¥æ‹·è´ä¸€ä¸ªæ–°çš„æ•°ç»„è¿”å›
    if (a.length < size) {
        return (T[]) Arrays.copyOf(elementData, size, a.getClass());
    }
    // ã€Š2ã€‹å¦åˆ™ç›´æ¥æ‹·è´æ•°ç»„å³å¯
    System.arraycopy(elementData, 0, a, 0, size);
    // é¢ è¿™ä¸ªçš„ç›®çš„æ˜¯ï¼Ÿ æœ‰ç‚¹æ²¡çœ‹æ‡‚
    if (a.length > size) {
        a[size] = null;
    }
    // è¿”å›ä¼ å…¥çš„aï¼Œä½†æ˜¯è€ƒè™‘åˆ°ã€Š1ã€‹çš„æ—¶å€™ä¼šè¿”å›æ–°çš„æ•°ç»„ï¼Œæ‰€ä»¥å³æ—¶ã€Š2ã€‹è¿”å›aæ•°ç»„ï¼Œæœ€å¥½è¿˜æ˜¯æŒ‰ç…§ a = list.toArray(a); æ¥ä½¿ç”¨
    return a;
}
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¼ å…¥çš„æ•°ç»„açš„é•¿åº¦å°äº ```ArrayList``` é›†åˆçš„å…ƒç´ çš„é•¿åº¦æ—¶å€™ï¼Œç›´æ¥æ‹·è´ç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°ç»„è¿”å›ï¼›å¦åˆ™å°† ```elementData``` å¤åˆ¶åˆ° `a` æ•°ç»„ä¸­ã€‚

è€ƒè™‘åˆ°```<1>``` å¤„æœ‰å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ‰€æœ‰å³ä½¿ ```<2>``` è¿”å›çš„å°±æ˜¯ ```a``` æ•°ç»„ï¼›ä½¿ç”¨çš„æ—¶å€™æœ€å¥½è¿˜æ˜¯æŒ‰ç…§ ```a = list.toArray(a)```ã€‚

### å…¶ä»–å¸¸è§æ–¹æ³•

å…¶ä»–æ¯”è¾ƒå¸¸è§çš„æ–¹æ³•ï¼Œæ¯”å¦‚åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  ```contains(Object o)``` æ–¹æ³•ã€è·å–æŒ‡å®šä½ç½®çš„å…ƒç´  ```get(int index)``` ã€è®¾ç½®æŒ‡å®šä½ç½®çš„å…ƒç´  ```set(int index, E element)```ã€æ¸…ç©ºæ•°ç»„ ```clear()```ã€è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£ä½†æ˜¯ä¸å’‹å¸¸ç”¨çš„æ–¹æ³•â€”â€”åˆ›å»ºå­æ•°ç»„ ```subList(int fromIndex, int toIndex)```

ç”±äºæ¯”è¾ƒç®€å•ï¼Œä¸€æ¬¡æ€§ä¸Šï¼ˆå¶é—®é™„ä½“ï¼šæˆ‘è¦ä¸€ä¸ªæ‰“åä¸ªï¼ï¼ï¼ï¼‰

```java
/**
  * åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å«æœ‰å…ƒç´  o
  * å¯ä»¥çœ‹å‡ºï¼Œcontainsæ–¹æ³•å…¶å®å°±æ˜¯ä¾èµ–çš„ indexOfæ–¹æ³•
  * @param o
  * @return boolean
  */
@Override
public boolean contains(Object o) {
    return indexOf(o) >= 0;
}

/**
  * è·å–æŒ‡å®šindexä½çš„å…ƒç´ 
  * @param index
  * @return E
  */
@Override
public E get(int index) {
    // å‚æ•°æ£€æŸ¥
    rangeCheck(index);

    // ç›¸å½“äºç›´æ¥è¿”å› elementData[index]; è«å¾—å‹åŠ›~
    return elementData(index);
}

/**
  * è®¾ç½®æŒ‡å®šindexä½ç½®çš„å…ƒç´ ï¼Œå¹¶ä¸”è¿”å›è¯¥indexä½æ—§å…ƒç´ å€¼
  * å¹¶è¿”å›æ—§å…ƒç´ çš„å€¼ï¼ˆç›¸å½“äºæ›¿æ¢ï¼‰
  * @param index
  * @param element
  * @return E
  */
@Override
public E set(int index, E element) {
    // å‚æ•°æ£€æŸ¥
    rangeCheck(index);
    // æ•°æ®çš„ç®€å•æ“ä½œ~~
    E oldValue = elementData(index);
    elementData[index] = element;
    return oldValue;
}


/**
  * æ¸…ç©ºé›†åˆ
  */
@Override
public void clear() {
    // æ•°ç»„æ“ä½œæ¬¡æ•° + 1ï¼Œè™½ç„¶ä¸çŸ¥é“è®°å½•è¿™ä¸ªä¸œä¸œæœ‰å•¥å­ç”¨
    modCount++;
    // éå†æ•°ç»„ï¼Œå…¨éƒ¨è®¾ç½®ä¸ºnull,åŒæ—¶æ›´æ–°sizeå€¼
    for (int i = 0; i < size; i++) {
        elementData[i] = null;
    }

    size = 0;
}


 /**
   * åˆ›å»ºå­æ•°ç»„
   * æ³¨æ„ï¼š subListå¹¶ä¸æ˜¯åªè¯»æ•°ç»„ï¼Œè€Œæ˜¯å’Œçˆ¶æ•°ç»„å…±äº«ç›¸åŒçš„ elementData çš„æ•°ç»„ï¼Œæ¢å¥è¯è¯´ï¼Œå¯¹subListçš„æ“ä½œä¼šå½±å“åˆ° çˆ¶æ•°ç»„
   * åªä¸è¿‡æ˜¯fromIndex å’Œ toIndexé™åˆ¶äº†æŸ¥çœ‹çš„èŒƒå›´
   * @param fromIndex å¼€å§‹ä¸‹æ ‡
   * @param toIndex ç»“æŸä¸‹æ ‡
   *                æ˜¯ä¸€ä¸ª [fromIndex, toIndex)çš„æ•ˆæœ
   */
public List<E> subList(int fromIndex, int toIndex) {
    subListRangeCheck(fromIndex, toIndex, size);
    return new SubList(this, 0, fromIndex, toIndex);
}
```

## éå†æ–¹å¼æ¢è®¨

```ArrayList``` æ”¯æŒä¸‰ç§éå†æ–¹å¼ï¼Œä¸‹é¢é€ä¸ªè®¨è®ºï¼š

- é€šè¿‡ ```Interator``` è¿­ä»£å™¨éå†

```java
Integer value = null;
Iterator it = list.iterator();
while (it.hasNext()) {
    value = (Integer)it.next();
}
```

- éšæœºè®¿é—®ï¼Œé€šè¿‡ç´¢å¼•å€¼éå†ï¼Œç”±äº ```ArrayList``` å®ç°äº† ```RandomAccess``` æ¥å£ï¼Œæ‰€ä»¥å®ƒæ”¯æŒé€šè¿‡ç´¢å¼•å€¼å»éšæœºè®¿é—®å…ƒç´ 

```java
Integer value = null;
int size = list.size();
for (int i = 0; i < size; i++) {
    value = (Integer)list.get(i);
}
```

- forå¾ªç¯éå†

```java

Integer value = null;
for (Integer integ : list) {
    value = integ;
}
```

**æµ‹è¯•æ¯”è¾ƒä¸‰è€…çš„æ•ˆç‡ï¼Œå¾—å‡ºåœ¨éå† ```ArrayList``` çš„æ—¶å€™ï¼Œä½¿ç”¨éšæœºè®¿é—®ï¼ˆå³é€šè¿‡ç´¢å¼•è®¿é—®ï¼‰çš„æ•ˆç‡æœ€é«˜ï¼Œè€Œä½¿ç”¨è¿­ä»£å™¨çš„æ•ˆç‡æœ€ä½**

## æ€»ç»“

æœ¬æ–‡ä¸»è¦è®²è§£äº† ```ArrayList``` çš„å±æ€§ã€æ„é€ æ–¹æ³•ã€æ ¸å¿ƒæ–¹æ³•ã€‚

```ArrayList``` åªæœ‰2ä¸ªå±æ€§ï¼Œåˆ†åˆ«ä¸º ```elementData``` ç”¨ä»¥å­˜å‚¨å…ƒç´ å’Œ ```size``` ä»£è¡¨å­˜å‚¨å…ƒç´ çš„æ•°é‡ã€‚

```ArrayList``` æœ‰3ä¸ªæ„é€ æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯æ— å‚æ„é€ æ–¹æ³• ```public ArrayList()```ã€æŒ‡å®šåˆå§‹åŒ–å¸¸é‡çš„æ„é€ æ–¹æ³• ```public ArrayList(int initialCapacity)```ã€æŒ‡å®šå…ƒç´ é›†çš„æ„é€ æ–¹æ³• ```ArrayList(Collection<? extends E> c)```ï¼›éœ€è¦ç‰¹åˆ«ç•™æ„çš„æ˜¯ï¼š**æ— å‚æ„é€ æ–¹æ³•é¦–æ¬¡åˆå§‹åŒ–çš„å®¹é‡æ˜¯0ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰©å®¹æˆå®¹é‡ä¸º10çš„æ•°ç»„**ã€‚

æ ¸å¿ƒæ–¹æ³•ä¸»è¦ä»‹ç»äº†å‡ ç±»ï¼Œåˆ†åˆ«ä¸ºï¼šæ–°å¢å…ƒç´ ã€åˆ é™¤å…ƒç´ ã€æŸ¥è¯¢å…ƒç´ ã€ä»¥åŠä¸€äº›å¸¸ç”¨çš„æ–¹æ³•ã€‚

æ–°å¢å…ƒç´ çš„æ—¶å€™ï¼Œç”±äº ```ArrayList``` æ˜¯æ”¯æŒåŠ¨æ€æ‰©å®¹çš„åŠ¨æ€æ•°ç»„ï¼Œæ‰€ä»¥æ–°å¢å…ƒç´ çš„æ—¶å€™ä¼šç¡®ä¿æ•°ç»„çš„å‰©ä½™å®¹é‡æ˜¯å¦æ”¯æŒæœ¬æ¬¡æ–°å¢å…ƒç´ æ“ä½œï¼Œå¦‚æœä¸æ»¡è¶³åˆ™ä¼šè§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œæ‰©å®¹ä¸€èˆ¬æ˜¯æŒ‰ç…§åŸæ¥**1.5**å€ã€‚

æˆ‘ä»¬åœ¨åˆ é™¤å…ƒç´ ç›¸å…³çš„æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œ```ArrayList``` åœ¨æ¯æ¬¡åˆ é™¤å…ƒç´ éƒ½ï¼Œéƒ½ä¼šä¼´éšç€å¤§é‡çš„ç§»åŠ¨å…ƒç´ çš„æ“ä½œï¼Œæ‰€ä»¥ä»ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡º ```ArrayList``` å¹¶ä¸æ˜¯é‚£ä¹ˆé€‚ç”¨äºæ–°å¢ã€åˆ é™¤æ¯”è¾ƒé¢‘ç¹çš„åœºæ™¯ã€‚

æŸ¥è¯¢å…ƒç´ å’Œä¸€äº›æ¯”è¾ƒå¸¸è§çš„æ–¹æ³•ï¼Œä»£ç éƒ½æ¯”è¾ƒç®€å•ï¼›ç›¸ä¿¡æœ‹å‹ä»¬å¯ä»¥ç›´æ¥è¯»æ‡‚ã€‚

å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæˆ‘ä»¬åœ¨å°† ```ArrayList``` è½¬æ¢æˆæ•°ç»„çš„æ—¶å€™ï¼Œè°ƒç”¨ ```toArray()``` æ–¹æ³•æœ‰å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸```java.lang.ClassCastException```ï¼Œè¿™æ˜¯å› ä¸ºè¯¥æ–¹æ³•è¿”å›çš„ç±»å‹æ˜¯ ```Object[]```ï¼Œä¸æ”¯æŒå‘ä¸‹è½¬æ¢ç±»å‹ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬éœ€è¦è¿”å›æŒ‡å®šæ³›å‹çš„æ•°ç»„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨```T[] toArray(T[] a)``` æ–¹æ³•ã€‚

æœ€åéœ€è¦ç•™æ„çš„æ˜¯ ```ArrayList``` æ˜¯æ”¯æŒå­˜å‚¨ ```null``` çš„ã€‚

----

> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![å…¬ä¼—å·äºŒç»´ç ](https://img-blog.csdnimg.cn/20201121225359995.png)
