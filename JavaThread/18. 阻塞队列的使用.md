> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----

åœ¨å‰é¢ä¸€ç¯‡æ–‡ç« ï¼šæ¡ä»¶é˜»å¡Conditionçš„åº”ç”¨ä¸­æåˆ°äº†ä¸€ä¸ªæ‹”é«˜çš„ä¾‹å­ï¼šåˆ©ç”¨ Condition æ¥å®ç°é˜»å¡é˜Ÿåˆ—ã€‚å…¶å®åœ¨ java ä¸­ï¼Œæœ‰ä¸ªå« `ArrayBlockingQueue<E>` çš„ç±»æä¾›äº†é˜»å¡é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœéœ€è¦ä½¿ç”¨é˜»å¡é˜Ÿåˆ—ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦è‡ªå·±å»å†™ã€‚

`ArrayBlockingQueue<E>` å®ç°äº† `BlockingQueue<E>`ï¼Œå¦å¤–è¿˜æœ‰ `LinkedBlockingQueue<E>` å’Œ `PriorityBlockingQueue<E>`ã€‚`ArrayBlockingQueue<E>` ä¸»è¦æ˜¯åŸºäºæ•°ç»„å®ç°çš„ï¼Œ`LinkedBlockingQueue<E>` æ˜¯åŸºäºé“¾è¡¨å®ç°çš„ï¼Œå®ƒä»¬éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºï¼›è€Œ `PriorityBlockingQueue<E>` æ˜¯åŸºäºä¼˜å…ˆçº§é˜Ÿåˆ—çš„ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ç”¨ `ArrayBlockingQueue<E>` ä¸¾ä¾‹ï¼Œå¦å¤–ä¸¤ä¸ªä½¿ç”¨æ–¹å¼å’Œ `ArrayBlockingQueue<E>` å·®ä¸å¤šï¼Œå…·ä½“çš„å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚

ä½¿ç”¨ `ArrayBlockingQueue<E>` éœ€è¦å…ˆæŒ‡æ˜ç¼“å­˜åŒºçš„å¤§å°ï¼ŒæŒ‡æ˜ä¹‹åå°±æ— æ³•ä¿®æ”¹ï¼Œè¯•å›¾å‘å·²æ»¡é˜Ÿåˆ—ä¸­æ”¾å…¥å…ƒç´ ä¼šå¯¼è‡´æ“ä½œå—é˜»å¡ï¼›è¯•å›¾ä»ç©ºé˜Ÿåˆ—ä¸­æå–å…ƒç´ å°†å¯¼è‡´ç±»ä¼¼é˜»å¡ã€‚ä¸‹é¢ä½¿ç”¨ `ArrayBlockingQueue<E>` æ¥å®ç°ç±»ä¼¼äºå‰é¢é‚£ç¯‡åšå®¢ä¸­æåˆ°çš„ä¸€ä¸ªåŠŸèƒ½ï¼š

```java
public class BlockingQueueTest {

	public static void main(String[] args) {
		final BlockingQueue<Integer> queue = new ArrayBlockingQueue<Integer>(3); //ç¼“å†²åŒºå…è®¸æ”¾3ä¸ªæ•°æ®
		
		for(int i = 0; i < 2; i ++) {
			new Thread() { //å¼€å¯ä¸¤ä¸ªçº¿ç¨‹ä¸åœçš„å¾€ç¼“å†²åŒºå­˜æ•°æ®
				
				@Override
				public void run() {
					while(true) {
						try {
							Thread.sleep((long) (Math.random()*1000));
							System.out.println(Thread.currentThread().getName() + "å‡†å¤‡æ”¾æ•°æ®"
									+ (queue.size() == 3?"..é˜Ÿåˆ—å·²æ»¡ï¼Œæ­£åœ¨ç­‰å¾…":"..."));
							queue.put(1);
							System.out.println(Thread.currentThread().getName() + "å­˜å…¥æ•°æ®ï¼Œ" 
									+ "é˜Ÿåˆ—ç›®å‰æœ‰" + queue.size() + "ä¸ªæ•°æ®");
						} catch (InterruptedException e) {
							// TODO Auto-generated catch block
							e.printStackTrace();
						} 
					}
				}
				
			}.start();
		}
		
		new Thread() { //å¼€å¯ä¸€ä¸ªçº¿ç¨‹ä¸åœçš„ä»ç¼“å†²åŒºå–æ•°æ®
			
			@Override
			public void run() {
				while(true) {
					try {
						Thread.sleep(1000);
						System.out.println(Thread.currentThread().getName() + "å‡†å¤‡å–æ•°æ®"
								+ (queue.size() == 0?"..é˜Ÿåˆ—å·²ç©ºï¼Œæ­£åœ¨ç­‰å¾…":"..."));
						queue.take();
						System.out.println(Thread.currentThread().getName() + "å–å‡ºæ•°æ®ï¼Œ" 
								+ "é˜Ÿåˆ—ç›®å‰æœ‰" + queue.size() + "ä¸ªæ•°æ®");
					} catch (InterruptedException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					} 
				}
			}
		}.start();
	}

}
```
ç¨‹åºçš„é€»è¾‘å¾ˆç®€å•ï¼Œä¸éš¾ç†è§£ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹è¿è¡Œçš„ç»“æœï¼š
>Thread-0å‡†å¤‡æ”¾æ•°æ®... <br>
Thread-0å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰1ä¸ªæ•°æ®<br>
Thread-1å‡†å¤‡æ”¾æ•°æ®...<br>
Thread-1å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰2ä¸ªæ•°æ®<br>
Thread-2å‡†å¤‡å–æ•°æ®...<br>
Thread-2å–å‡ºæ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰1ä¸ªæ•°æ®<br>
Thread-0å‡†å¤‡æ”¾æ•°æ®...<br>
Thread-0å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰2ä¸ªæ•°æ®<br>
Thread-1å‡†å¤‡æ”¾æ•°æ®...<br>
Thread-1å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰3ä¸ªæ•°æ®<br>
Thread-2å‡†å¤‡å–æ•°æ®...<br>
Thread-2å–å‡ºæ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰2ä¸ªæ•°æ®<br>
Thread-0å‡†å¤‡æ”¾æ•°æ®...<br>
Thread-0å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰3ä¸ªæ•°æ®<br>
Thread-1å‡†å¤‡æ”¾æ•°æ®..é˜Ÿåˆ—å·²æ»¡ï¼Œæ­£åœ¨ç­‰å¾…<br>
Thread-0å‡†å¤‡æ”¾æ•°æ®..é˜Ÿåˆ—å·²æ»¡ï¼Œæ­£åœ¨ç­‰å¾…<br>
Thread-2å‡†å¤‡å–æ•°æ®...<br>
Thread-2å–å‡ºæ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰2ä¸ªæ•°æ®<br>
Thread-1å­˜å…¥æ•°æ®ï¼Œé˜Ÿåˆ—ç›®å‰æœ‰3ä¸ªæ•°æ®<br>

æ‰€ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—å°±éå¸¸æ–¹ä¾¿äº†ï¼Œä¸ç”¨æˆ‘ä»¬äººä¸ºçš„å»åšåˆ¤æ–­äº†ã€‚

ä¹‹å‰åœ¨æ–‡ç« é‡Œä»‹ç»è¿‡çº¿ç¨‹é—´é€šä¿¡å¯ä»¥ä½¿ç”¨ synchronized å’Œ waitã€notify ç»„åˆï¼Œå¯ä»¥ä½¿ç”¨ Conditionï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é˜»å¡é˜Ÿåˆ—æ¥å®ç°çº¿ç¨‹é—´çš„é€šä¿¡ï¼Œä¸‹é¢ä¸¾ä¸ªç¤ºä¾‹ï¼š

```java
//é˜»å¡é˜Ÿåˆ—å®ç°çº¿ç¨‹é—´é€šä¿¡
public class BlockingQueueCommunication {

    public static void main(String[] args) {
        Business bussiness = new Business();

        new Thread(new Runnable() {// å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹

                    @Override
                    public void run() {
                        for (int i = 1; i <= 3; i++) {

                            bussiness.sub();
                        }

                    }
                }).start();

        // mainæ–¹æ³•ä¸»çº¿ç¨‹
        for (int i = 1; i <= 3; i++) {

            bussiness.main();
        }
    }   
}

class Business {

	private int i = 0;
	
    BlockingQueue queue1 = new ArrayBlockingQueue(1);
    BlockingQueue queue2 = new ArrayBlockingQueue(1);
    
    {
    	try {
			queue2.put(1);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
    }

    public void sub() {
        try {
			queue1.put(1); //å¦‚æœä¸»çº¿ç¨‹æ²¡æ‰§è¡Œå®Œï¼Œåˆ™å­çº¿ç¨‹ç¼“å†²åŒºä¸€ç›´æœ‰æ•°ï¼Œå­çº¿ç¨‹åœ¨è¿™é‡Œè¢«é˜»å¡
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
        
        System.out.println("å­çº¿ç¨‹æ‰§è¡Œå‰i=" + i++);
        System.out.println("å­çº¿ç¨‹æ‰§è¡Œåi=" + i);
        
        try {
			queue2.take(); //å–å‡ºä¸»çº¿ç¨‹ä¸­ç¼“å†²åŒºçš„æ•°ï¼Œè®©ä¸»çº¿ç¨‹æ‰§è¡Œ
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
    }

    public void main() {
        try {
			queue2.put(1); //å¦‚æœå­çº¿ç¨‹æ²¡æ‰§è¡Œå®Œï¼Œåˆ™ä¸»çº¿ç¨‹ç¼“å†²åŒºä¸€ç›´æœ‰æ•°ï¼Œä¸»çº¿ç¨‹åœ¨è¿™é‡Œè¢«é˜»å¡
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
        
        System.out.println("ä¸»çº¿ç¨‹æ‰§è¡Œå‰i=" + i++);
        System.out.println("ä¸»çº¿ç¨‹æ‰§è¡Œåi=" + i);
        
        try {
			queue1.take(); //å–å‡ºå­çº¿ç¨‹ä¸­ç¼“å†²åŒºçš„æ•°ï¼Œè®©å­çº¿ç¨‹æ‰§è¡Œ
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
    }
}
```
ä»£ç çœ‹èµ·æ¥æœ‰ç‚¹é•¿ï¼Œä½†æ˜¯é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹ä½ ä¸€ä¸‹æˆ‘ä¸€ä¸‹ï¼Œè½®æµæ‰§è¡Œï¼Œæ‰§è¡Œçš„ä»»åŠ¡å°±æ˜¯å°†å…¬å…±æ•°æ®iè‡ªå¢1ï¼Œä½¿ç”¨é˜»å¡é˜Ÿåˆ—å®ç°çš„ï¼Œè€Œä¸”çº¿ç¨‹å®‰å…¨ï¼Œå› ä¸ºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æ˜¯è¢«é˜»å¡çš„ã€‚

è®¾è®¡æ€æƒ³æ˜¯è¿™æ ·çš„ï¼Œå®šä¹‰ä¸¤ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œåˆ†åˆ«åªèƒ½æ”¾1ä¸ªæ•°ï¼Œåˆ†åˆ«å¯¹åº”ä¸¤ä¸ªçº¿ç¨‹ã€‚é‚£ä¹ˆæˆ‘åœ¨é™æ€ä»£ç å—ä¸­å…ˆå°†ä¸»çº¿ç¨‹çš„é˜Ÿåˆ—å¡æ»¡ï¼Œç„¶åæˆ‘è®©ä¸¤ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œä»»åŠ¡ä¹‹å‰ï¼Œå…ˆå¾€å„è‡ªçš„é˜Ÿåˆ—ä¸­å¡ä¸€ä¸ªæ•°ï¼Œé‚£ä¹ˆè‚¯å®šä¸»çº¿ç¨‹è‚¯å®šè¢«é˜»å¡ï¼Œå› ä¸ºæˆ‘ä¹‹å‰å·²ç»åœ¨é™æ€ä»£ç å—ä¸­ç»™ä¸»çº¿ç¨‹çš„é˜Ÿåˆ—å¡è¿‡ä¸€ä¸ªæ•°äº†ã€‚ç„¶åå­çº¿ç¨‹åœ¨æ‰§è¡Œå®Œä»»åŠ¡åï¼ŒæŠŠä¸»çº¿ç¨‹é˜Ÿåˆ—ä¸­çš„æ•°å–å‡ºï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹å°±å¼€å§‹æ‰§è¡Œäº†ï¼Œå­çº¿ç¨‹æ­¤æ—¶è¢«é˜»å¡ï¼ˆå› ä¸ºåˆšåˆšå®ƒè‡ªå·±æ‰§è¡Œä»»åŠ¡å‰å¡äº†ä¸ªæ•°ï¼‰ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œå®Œæ‹¿å‡ºå­çº¿ç¨‹é˜Ÿåˆ—ä¸­çš„æ•°ï¼Œè¿™æ—¶å€™å­çº¿ç¨‹åˆå¼€å§‹æ‰§è¡Œäº†ã€‚æ‰€ä»¥åˆ©ç”¨äº†é˜»å¡é˜Ÿåˆ—ä¼šé˜»å¡ä¸€ä¸ªçº¿ç¨‹çš„åŠæ³•æ¥å®ç°ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´äº¤æ›¿æ‰§è¡Œã€‚

å…³äºé˜»å¡é˜Ÿåˆ—çš„ä½¿ç”¨ï¼Œå°±æ€»ç»“è¿™ä¹ˆå¤šå§ï¼å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿è®¨è®ºï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ã€‚

----

> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----