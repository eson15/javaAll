> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----

Condition å°† Object ç›‘è§†å™¨æ–¹æ³•ï¼ˆwaitã€notify å’Œ notifyAllï¼‰åˆ†è§£æˆæˆªç„¶ä¸åŒçš„å¯¹è±¡ï¼Œä»¥ä¾¿é€šè¿‡å°†è¿™äº›å¯¹è±¡ä¸ä»»æ„ Lock å®ç°ç»„åˆä½¿ç”¨ï¼Œä¸ºæ¯ä¸ªå¯¹è±¡æä¾›å¤šä¸ªç­‰å¾… setï¼ˆwait-setï¼‰ã€‚å…¶ä¸­ï¼ŒLock æ›¿ä»£äº† synchronized æ–¹æ³•å’Œè¯­å¥çš„ä½¿ç”¨ï¼ŒCondition æ›¿ä»£äº† Object ç›‘è§†å™¨æ–¹æ³•çš„ä½¿ç”¨ã€‚

## 1. Conditionçš„åŸºæœ¬ä½¿ç”¨

ç”±äº Condition å¯ä»¥ç”¨æ¥æ›¿ä»£ waitã€notify ç­‰æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ¯”ç€ä¹‹å‰å†™è¿‡çš„çº¿ç¨‹é—´é€šä¿¡çš„ä»£ç æ¥çœ‹ï¼Œå†æ¥çœ‹ä¸€ä¸‹åŸæ¥é‚£ä¸ªé—®é¢˜ï¼š

>æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå­çº¿ç¨‹å…ˆæ‰§è¡Œ10æ¬¡ï¼Œç„¶åä¸»çº¿ç¨‹æ‰§è¡Œ5æ¬¡ï¼Œç„¶åå†åˆ‡æ¢åˆ°å­çº¿ç¨‹æ‰§è¡Œ10ï¼Œå†ä¸»çº¿ç¨‹æ‰§è¡Œ5æ¬¡â€¦â€¦å¦‚æ­¤å¾€è¿”æ‰§è¡Œ50æ¬¡ã€‚

ä¹‹å‰ç”¨ wait å’Œ notify æ¥å®ç°çš„ï¼Œç°åœ¨ç”¨ Condition æ¥æ”¹å†™ä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public class ConditionCommunication {

	public static void main(String[] args) {
		Business bussiness = new Business();

		new Thread(new Runnable() {// å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹

					@Override
					public void run() {
						for (int i = 1; i <= 50; i++) {

							bussiness.sub(i);
						}

					}
				}).start();

		// mainæ–¹æ³•ä¸»çº¿ç¨‹
		for (int i = 1; i <= 50; i++) {

			bussiness.main(i);
		}
	}	
}

class Business {

	Lock lock = new ReentrantLock();
	Condition condition = lock.newCondition(); //Conditionæ˜¯åœ¨å…·ä½“çš„lockä¹‹ä¸Šçš„

	private boolean bShouldSub = true;

	public void sub(int i) {
		lock.lock();
		try {
			while (!bShouldSub) {
				try {
					condition.await(); //ç”¨conditionæ¥è°ƒç”¨awaitæ–¹æ³•
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
			for (int j = 1; j <= 10; j++) {
				System.out.println("sub thread sequence of " + j
						+ ", loop of " + i);
			}
			bShouldSub = false;
			condition.signal(); //ç”¨conditionæ¥å‘å‡ºå”¤é†’ä¿¡å·ï¼Œå”¤é†’æŸä¸€ä¸ª
		} finally {
			lock.unlock();
		}
	}

	public void main(int i) {
		lock.lock();
		try {
			while (bShouldSub) {
				try {
					condition.await(); //ç”¨conditionæ¥è°ƒç”¨awaitæ–¹æ³•
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
			for (int j = 1; j <= 10; j++) {
				System.out.println("main thread sequence of " + j
						+ ", loop of " + i);
			}
			bShouldSub = true;
			condition.signal(); //ç”¨conditionæ¥å‘å‡ºå”¤é†’ä¿¡å·ä¹ˆï¼Œå”¤é†’æŸä¸€ä¸ª
		} finally {
			lock.unlock();
		}
	}
}
```
ä»ä»£ç æ¥çœ‹ï¼ŒCondition çš„ä½¿ç”¨æ—¶å’Œ Lock ä¸€èµ·çš„ï¼Œæ²¡æœ‰ Lock å°±æ²¡æ³•ä½¿ç”¨ Conditionï¼Œå› ä¸º Condition æ˜¯é€šè¿‡ Lock æ¥ new å‡ºæ¥çš„ï¼Œè¿™ç§ç”¨æ³•å¾ˆç®€å•ï¼Œåªè¦æŒæ¡äº† synchronized å’Œ waitã€notify çš„ä½¿ç”¨ï¼Œå®Œå…¨å¯ä»¥æŒæ¡ Lock å’Œ Condition çš„ä½¿ç”¨ã€‚

## 2. Conditionçš„æ‹”é«˜

### 2.1 ç¼“å†²åŒºçš„é˜»å¡é˜Ÿåˆ—

ä¸Šé¢ä½¿ç”¨ Lock å’Œ Condition æ¥ä»£æ›¿ synchronized å’Œ Object ç›‘è§†å™¨æ–¹æ³•å®ç°äº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œç°åœ¨å†æ¥å†™ä¸ªç¨å¾®é«˜çº§ç‚¹åº”ç”¨ï¼šæ¨¡æ‹Ÿç¼“å†²åŒºçš„é˜»å¡é˜Ÿåˆ—ã€‚

ä»€ä¹ˆå«ç¼“å†²åŒºå‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œç°åœ¨æœ‰å¾ˆå¤šäººè¦å‘æ¶ˆæ¯ï¼Œæˆ‘æ˜¯ä¸­è½¬ç«™ï¼Œæˆ‘è¦å¸®åˆ«äººæŠŠæ¶ˆæ¯å‘å‡ºå»ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ã€€ã€€å°±éœ€è¦åšä¸¤ä»¶äº‹ï¼Œä¸€ä»¶äº‹æ˜¯æ¥æ”¶ç”¨æˆ·å‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå¹¶æŒ‰é¡ºåºæ”¾åˆ°ç¼“å†²åŒºï¼Œå¦ä¸€ä»¶äº‹æ˜¯ä»ç¼“å†²åŒºä¸­æŒ‰é¡ºåºå–å‡ºç”¨æˆ·å‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå¹¶å‘é€å‡ºå»ã€‚

ç°åœ¨æŠŠè¿™ä¸ªå®é™…çš„é—®é¢˜æŠ½è±¡ä¸€ä¸‹ï¼šç¼“å†²åŒºå³ä¸€ä¸ªæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥å‘æ•°ç»„ä¸­å†™å…¥æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä»æ•°ç»„ä¸­æŠŠæ•°æ®å–èµ°ï¼Œæˆ‘è¦åšçš„ä¸¤ä»¶äº‹å°±æ˜¯å¼€å¯ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªå­˜æ•°æ®ï¼Œä¸€ä¸ªå–æ•°æ®ã€‚ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œå¦‚æœç¼“å†²åŒºæ»¡äº†ï¼Œè¯´æ˜æ¥æ”¶çš„æ¶ˆæ¯å¤ªå¤šäº†ï¼Œå³å‘é€è¿‡æ¥çš„æ¶ˆæ¯å¤ªå¿«äº†ï¼Œæˆ‘å¦ä¸€ä¸ªçº¿ç¨‹è¿˜æ¥ä¸åŠå‘å®Œï¼Œå¯¼è‡´ç°åœ¨ç¼“å†²åŒºæ²¡åœ°æ–¹æ”¾äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±å¾—é˜»å¡å­˜æ•°æ®è¿™ä¸ªçº¿ç¨‹ï¼Œè®©å…¶ç­‰å¾…ï¼›ç›¸åï¼Œå¦‚æœæˆ‘è½¬å‘çš„å¤ªå¿«ï¼Œç°åœ¨ç¼“å†²åŒºæ‰€æœ‰å†…å®¹éƒ½è¢«æˆ‘å‘å®Œäº†ï¼Œè¿˜æ²¡æœ‰ç”¨æˆ·å‘æ–°çš„æ¶ˆæ¯æ¥ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±å¾—é˜»å¡å–æ•°æ®è¿™ä¸ªçº¿ç¨‹ã€‚

å¥½äº†ï¼Œåˆ†æå®Œäº†è¿™ä¸ªç¼“å†²åŒºçš„é˜»å¡é˜Ÿåˆ—ï¼Œä¸‹é¢å°±ç”¨ConditionæŠ€æœ¯æ¥å®ç°ä¸€ä¸‹ï¼š

```java
class Buffer {
	final Lock lock = new ReentrantLock(); //å®šä¹‰ä¸€ä¸ªé”
	final Condition notFull = lock.newCondition(); //å®šä¹‰é˜»å¡é˜Ÿåˆ—æ»¡äº†çš„Condition
	final Condition notEmpty = lock.newCondition();//å®šä¹‰é˜»å¡é˜Ÿåˆ—ç©ºäº†çš„Condition

	final Object[] items = new Object[10]; //ä¸ºäº†ä¸‹é¢æ¨¡æ‹Ÿï¼Œè®¾ç½®é˜»å¡é˜Ÿåˆ—çš„å¤§å°ä¸º10ï¼Œä¸è¦è®¾å¤ªå¤§
	
	int putptr, takeptr, count; //æ•°ç»„ä¸‹æ ‡ï¼Œç”¨æ¥æ ‡å®šä½ç½®çš„

	//å¾€é˜Ÿåˆ—ä¸­å­˜æ•°æ®
	public void put(Object x) throws InterruptedException {
		lock.lock(); //ä¸Šé”
		try {
			while (count == items.length) {
				System.out.println(Thread.currentThread().getName() + " è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å­˜æ•°æ®ï¼");
				notFull.await();	//å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œé‚£ä¹ˆé˜»å¡å­˜æ•°æ®è¿™ä¸ªçº¿ç¨‹ï¼Œç­‰å¾…è¢«å”¤é†’
			}
			//å¦‚æœæ²¡æ»¡ï¼ŒæŒ‰é¡ºåºå¾€æ•°ç»„ä¸­å­˜
			items[putptr] = x;
			if (++putptr == items.length) //è¿™æ˜¯åˆ°è¾¾æ•°ç»„æœ«ç«¯çš„åˆ¤æ–­ï¼Œå¦‚æœåˆ°äº†ï¼Œå†å›åˆ°å§‹ç«¯
				putptr = 0;
			++count;	//æ¶ˆæ¯æ•°é‡
			System.out.println(Thread.currentThread().getName() + " å­˜å¥½äº†å€¼ï¼š " + x);
			notEmpty.signal(); //å¥½äº†ï¼Œç°åœ¨é˜Ÿåˆ—ä¸­æœ‰æ•°æ®äº†ï¼Œå”¤é†’é˜Ÿåˆ—ç©ºçš„é‚£ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥å–æ•°æ®å•¦
		} finally {
			lock.unlock(); //æ”¾é”
		}
	}

	//ä»é˜Ÿåˆ—ä¸­å–æ•°æ®
	public Object take() throws InterruptedException {
		lock.lock(); //ä¸Šé”
		try {
			while (count == 0) {
				System.out.println(Thread.currentThread().getName() + " è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼");
				notEmpty.await();  //å¦‚æœé˜Ÿåˆ—æ˜¯ç©ºï¼Œé‚£ä¹ˆé˜»å¡å–æ•°æ®è¿™ä¸ªçº¿ç¨‹ï¼Œç­‰å¾…è¢«å”¤é†’
			}
			//å¦‚æœæ²¡ç©ºï¼ŒæŒ‰é¡ºåºä»æ•°ç»„ä¸­å–
			Object x = items[takeptr];
			if (++takeptr == items.length) //åˆ¤æ–­æ˜¯å¦åˆ°è¾¾æœ«ç«¯ï¼Œå¦‚æœåˆ°äº†ï¼Œå†å›åˆ°å§‹ç«¯
				takeptr = 0;
			--count; //æ¶ˆæ¯æ•°é‡
			System.out.println(Thread.currentThread().getName() + " å–å‡ºäº†å€¼ï¼š " + x);
			notFull.signal(); //å¥½äº†ï¼Œç°åœ¨é˜Ÿåˆ—ä¸­æœ‰ä½ç½®äº†ï¼Œå”¤é†’é˜Ÿåˆ—æ»¡çš„é‚£ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥å­˜æ•°æ®å•¦
			return x;
		} finally {
			lock.unlock(); //æ”¾é”
		}
	}
}
```

è¿™ä¸ªç¨‹åºå¾ˆç»å…¸ï¼Œæˆ‘ä»å®˜æ–¹ JDK æ–‡æ¡£ä¸­æ‹¿å‡ºæ¥çš„ï¼Œç„¶ååŠ äº†æ³¨é‡Šã€‚ç¨‹åºä¸­å®šä¹‰äº†ä¸¤ä¸ª Conditionï¼Œåˆ†åˆ«é’ˆå¯¹ä¸¤ä¸ªçº¿ç¨‹ï¼Œç­‰å¾…å’Œå”¤é†’åˆ†åˆ«ç”¨ä¸åŒçš„ Condition æ¥æ‰§è¡Œï¼Œæ€è·¯å¾ˆæ¸…æ™°ï¼Œç¨‹åºä¹Ÿå¾ˆå¥å£®ã€‚å¯ä»¥è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºå•¥è¦ç”¨ä¸¤ä¸ª Condition å‘¢ï¼Ÿä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡è‚¯å®šæ˜¯æœ‰åŸå› çš„ï¼Œå¦‚æœç”¨ä¸€ä¸ª Conditionï¼Œç°åœ¨å‡è®¾é˜Ÿåˆ—æ»¡äº†ï¼Œä½†æ˜¯æœ‰2ä¸ªçº¿ç¨‹Aå’ŒBåŒæ—¶å­˜æ•°æ®ï¼Œé‚£ä¹ˆéƒ½è¿›å…¥äº†ç¡çœ ï¼Œå¥½ï¼Œç°åœ¨å¦ä¸€ä¸ªçº¿ç¨‹å–èµ°ä¸€ä¸ªäº†ï¼Œç„¶åå”¤é†’äº†å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹Aï¼Œé‚£ä¹ˆAå¯ä»¥å­˜äº†ï¼Œå­˜å®Œåï¼ŒAåˆå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœBè¢«å”¤é†’äº†ï¼Œé‚£å°±å‡ºé—®é¢˜äº†ï¼Œå› ä¸ºæ­¤æ—¶é˜Ÿåˆ—æ˜¯æ»¡çš„ï¼ŒBä¸èƒ½å­˜çš„ï¼ŒBå­˜çš„è¯å°±ä¼šè¦†ç›–åŸæ¥è¿˜æ²¡è¢«å–èµ°çš„å€¼ï¼Œå°±å› ä¸ºä½¿ç”¨äº†ä¸€ä¸ª Conditionï¼Œå­˜å’Œå–éƒ½ç”¨è¿™ä¸ª Condition æ¥ç¡çœ å’Œå”¤é†’ï¼Œå°±ä¹±äº†å¥—ã€‚åˆ°è¿™é‡Œï¼Œå°±èƒ½ä½“ä¼šåˆ°è¿™ä¸ª Condition çš„ç”¨æ­¦ä¹‹åœ°äº†ï¼Œç°åœ¨æ¥æµ‹è¯•ä¸€ä¸‹ä¸Šé¢çš„é˜»å¡é˜Ÿåˆ—çš„æ•ˆæœï¼š

```java
public class BoundedBuffer {
	
	public static void main(String[] args) {
		
		Buffer buffer = new Buffer();
		
		for(int i = 0; i < 5; i ++) { //å¼€å¯5ä¸ªçº¿ç¨‹å¾€ç¼“å†²åŒºå­˜æ•°æ®
			new Thread(new Runnable() {
				
				@Override
				public void run() {
					try {
						buffer.put(new Random().nextInt(1000)); //éšæœºå­˜æ•°æ®
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
				}
			}).start();
		}
		
		for(int i = 0; i < 10; i ++) { //å¼€å¯10ä¸ªçº¿ç¨‹ä»ç¼“å†²åŒºä¸­å–æ•°æ®
			new Thread(new Runnable() {
				
				@Override
				public void run() {
					try {
						buffer.take(); //ä»ç¼“å†²åŒºå–æ•°æ®
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
				}
			}).start();
		}
	}
}
```
æˆ‘æ•…æ„åªå¼€å¯5ä¸ªçº¿ç¨‹å­˜æ•°æ®ï¼Œ10ä¸ªçº¿ç¨‹å–æ•°æ®ï¼Œå°±æ˜¯æƒ³è®©å®ƒå‡ºç°å–æ•°æ®è¢«é˜»å¡çš„æƒ…å†µå‘ç”Ÿï¼Œçœ‹è¿è¡Œçš„ç»“æœï¼š

>Thread-5 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-10 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-1 å­˜å¥½äº†å€¼ï¼š 755<br>
Thread-0 å­˜å¥½äº†å€¼ï¼š 206<br>
Thread-2 å­˜å¥½äº†å€¼ï¼š 741<br>
Thread-3 å­˜å¥½äº†å€¼ï¼š 381<br>
Thread-14 å–å‡ºäº†å€¼ï¼š 755<br>
Thread-4 å­˜å¥½äº†å€¼ï¼š 783<br>
Thread-6 å–å‡ºäº†å€¼ï¼š 206<br>
Thread-7 å–å‡ºäº†å€¼ï¼š 741<br>
Thread-8 å–å‡ºäº†å€¼ï¼š 381<br>
Thread-9 å–å‡ºäº†å€¼ï¼š 783<br>
Thread-5 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-11 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-12 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-10 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>
Thread-13 è¢«é˜»å¡äº†ï¼Œæš‚æ—¶æ— æ³•å–æ•°æ®ï¼<br>

ä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œçº¿ç¨‹5å’Œ10æŠ¢å…ˆæ‰§è¡Œï¼Œå‘ç°é˜Ÿåˆ—ä¸­æ²¡æœ‰ï¼Œäºæ˜¯å°±è¢«é˜»å¡äº†ï¼Œç¡åœ¨é‚£äº†ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰æ–°çš„å€¼å­˜å…¥æ‰å¯ä»¥å–ï¼Œä½†æ˜¯å®ƒä»¬ä¸¤è¿æ°”ä¸å¥½ï¼Œå­˜çš„æ•°æ®åˆè¢«å…¶ä»–çº¿ç¨‹ç»™æŠ¢å…ˆå–èµ°äº†ï¼Œå“ˆå“ˆâ€¦â€¦å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ã€‚å¦‚æœæƒ³è¦çœ‹åˆ°å­˜æ•°æ®è¢«é˜»å¡ï¼Œå¯ä»¥å°†å–æ•°æ®çš„çº¿ç¨‹è®¾ç½®å°‘ä¸€ç‚¹ï¼Œè¿™é‡Œæˆ‘å°±ä¸è®¾äº†ã€‚

### 2.2 ä¸¤ä¸ªä»¥ä¸Šçº¿ç¨‹ä¹‹é—´çš„å”¤é†’

è¿˜æ˜¯åŸæ¥é‚£ä¸ªé¢˜ç›®ï¼Œç°åœ¨è®©ä¸‰ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š

>æœ‰ä¸‰ä¸ªçº¿ç¨‹ï¼Œå­çº¿ç¨‹1å…ˆæ‰§è¡Œ10æ¬¡ï¼Œç„¶åå­çº¿ç¨‹2æ‰§è¡Œ10æ¬¡ï¼Œç„¶åä¸»çº¿ç¨‹æ‰§è¡Œ5æ¬¡ï¼Œç„¶åå†åˆ‡æ¢åˆ°å­çº¿ç¨‹1æ‰§è¡Œ10æ¬¡ï¼Œå­çº¿ç¨‹2æ‰§è¡Œ10æ¬¡ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œ5æ¬¡â€¦â€¦å¦‚æ­¤å¾€è¿”æ‰§è¡Œ50æ¬¡ã€‚

å¦‚è¿‡ä¸ç”¨ Conditionï¼Œè¿˜çœŸä¸å¥½å¼„ï¼Œä½†æ˜¯ç”¨ Condition æ¥åšçš„è¯ï¼Œå°±éå¸¸æ–¹ä¾¿äº†ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå®šä¹‰ä¸‰ä¸ª Conditionï¼Œå­çº¿ç¨‹1æ‰§è¡Œå®Œå”¤é†’å­çº¿ç¨‹2ï¼Œå­çº¿ç¨‹2æ‰§è¡Œå®Œå”¤é†’ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œå®Œå”¤é†’å­çº¿ç¨‹1ã€‚å”¤é†’æœºåˆ¶å’Œä¸Šé¢é‚£ä¸ªç¼“å†²åŒºé“ç†å·®ä¸å¤šï¼Œä¸‹é¢çœ‹çœ‹ä»£ç å§ï¼Œå¾ˆå®¹æ˜“ç†è§£ã€‚

```java 
public class ThreeConditionCommunication {

	public static void main(String[] args) {
		Business bussiness = new Business();

		new Thread(new Runnable() {// å¼€å¯ä¸€ä¸ªå­çº¿ç¨‹

					@Override
					public void run() {
						for (int i = 1; i <= 50; i++) {

							bussiness.sub1(i);
						}

					}
				}).start();
		
		new Thread(new Runnable() {// å¼€å¯å¦ä¸€ä¸ªå­çº¿ç¨‹

			@Override
			public void run() {
				for (int i = 1; i <= 50; i++) {

					bussiness.sub2(i);
				}

			}
		}).start();

		// mainæ–¹æ³•ä¸»çº¿ç¨‹
		for (int i = 1; i <= 50; i++) {

			bussiness.main(i);
		}
	}

	static class Business {

		Lock lock = new ReentrantLock();
		Condition condition1 = lock.newCondition(); //Conditionæ˜¯åœ¨å…·ä½“çš„lockä¹‹ä¸Šçš„
		Condition condition2 = lock.newCondition();
		Condition conditionMain = lock.newCondition();

		private int bShouldSub = 0;

		public void sub1(int i) {
			lock.lock();
			try {
				while (bShouldSub != 0) {
					try {
						condition1.await(); //ç”¨conditionæ¥è°ƒç”¨awaitæ–¹æ³•
					} catch (Exception e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
				for (int j = 1; j <= 10; j++) {
					System.out.println("sub1 thread sequence of " + j
							+ ", loop of " + i);
				}
				bShouldSub = 1;
				condition2.signal(); //è®©çº¿ç¨‹2æ‰§è¡Œ
			} finally {
				lock.unlock();
			}
		}
		
		public void sub2(int i) {
			lock.lock();
			try {
				while (bShouldSub != 1) {
					try {
						condition2.await(); //ç”¨conditionæ¥è°ƒç”¨awaitæ–¹æ³•
					} catch (Exception e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
				for (int j = 1; j <= 10; j++) {
					System.out.println("sub2 thread sequence of " + j
							+ ", loop of " + i);
				}
				bShouldSub = 2;
				conditionMain.signal(); //è®©ä¸»çº¿ç¨‹æ‰§è¡Œ
			} finally {
				lock.unlock();
			}
		}

		public void main(int i) {
			lock.lock();
			try {
				while (bShouldSub != 2) {
					try {
						conditionMain.await(); //ç”¨conditionæ¥è°ƒç”¨awaitæ–¹æ³•
					} catch (Exception e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
				}
				for (int j = 1; j <= 5; j++) {
					System.out.println("main thread sequence of " + j
							+ ", loop of " + i);
				}
				bShouldSub = 0;
				condition1.signal(); //è®©çº¿ç¨‹1æ‰§è¡Œ
			} finally {
				lock.unlock();
			}
		}
	}
}
```
ä»£ç çœ‹ä¼¼æœ‰ç‚¹é•¿ï¼Œä½†æ˜¯æ˜¯å‡è±¡ï¼Œé€»è¾‘éå¸¸ç®€å•ã€‚å…³äºçº¿ç¨‹ä¸­çš„ Condition æŠ€æœ¯å°±æ€»ç»“è¿™ä¹ˆå¤šå§ã€‚å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿è®¨è®ºï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼

----

> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œè€é“ä»¬é¡ºä¾¿å…³æ³¨ä¸€ä¸‹æˆ‘çš„å…¬ä¼—å·ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ã€**Javaç§ƒå¤´å“¥**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----