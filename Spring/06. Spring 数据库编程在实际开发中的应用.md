> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œå…¬ä¼—å·ä¸èƒ½ä¸å…³æ³¨ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘ä»¬åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----

å°ä¼™ä¼´å„¿ä»¬ï¼Œå¤§å®¶å¥½ï¼ä¸Šä¸€ç¯‡æˆ‘ä»¬å­¦ä¹ äº† Spring æ•°æ®åº“ç¼–ç¨‹çš„åŸºæœ¬çŸ¥è¯†ï¼Œç°åœ¨æˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹Springä¸­çš„æ•°æ®åº“ç¼–ç¨‹åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚

![image-20201025202338672](https://gitee.com/Huke-123/PicCloud/raw/master/20201025202338.png)

## 1. åœ¨daoä¸­å®šä¹‰JdbcTemplate

æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­æ˜¯åŸºäºdaoä½¿ç”¨JdbcTemplateçš„ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹æ­¥éª¤ï¼›

### 1.1 åˆ›å»ºå®ä½“ç±»

```java
package com.java.model;

import java.io.Serializable;

public class Account implements Serializable {

    private int id;
    private int money;
    private String name;

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public int getMoney() {
        return money;
    }

    public void setMoney(int money) {
        this.money = money;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @Override
    public String toString() {
        return "com.java.model.Account{" +
                "id=" + id +
                ", money=" + money +
                ", name='" + name + '\'' +
                '}';
    }
}

```

### 1.2 å†™ä¸€ä¸ªdaoæ¥å£

```java
package com.java.dao;

import com.java.model.Account;

/*
è´¦æˆ·æŒä¹…å±‚æ¥å£
 */
public interface IAccountDao {
    //æ ¹æ®IdæŸ¥è¯¢è´¦æˆ·
    Account findAccountById(int accountId);
    //æ ¹æ®åç§°æŸ¥è¯¢è´¦æˆ·
    Account findAccountByName(String accountName);
    //æ›´æ–°è´¦æˆ·
    void updateAccunt(Account account);
}

```

### 1.3 å…·ä½“å®ç°ç±»

```java
package com.java.dao.impl;

import com.java.dao.IAccountDao;
import com.java.model.Account;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;

import java.util.List;

public class AccountDaoImpl implements IAccountDao {

    private JdbcTemplate jdbcTemplate;

    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public Account findAccountById(int accountId) {
        List<Account> accounts= jdbcTemplate.query("select * from t_account where id = ?",new BeanPropertyRowMapper<Account>(Account.class),accountId);
        return accounts.isEmpty()?null:accounts.get(0);
    }

    public Account findAccountByName(String accountName) {
        List<Account> accounts= jdbcTemplate.query("select * from t_account where name = ?",new BeanPropertyRowMapper<Account>(Account.class),accountName);
        if(accounts.isEmpty()){
            return null;
        }
        if(accounts.size()>1){
            throw new RuntimeException("ç»“æœé›†ä¸å”¯ä¸€");
        }
        return accounts.get(0);
    }

    public void updateAccount(Account account) {
        jdbcTemplate.update("update t_account set name=?,money=? where id=?",account.getName(),account.getMoney(),account.getId());
    }
}

```

### 1.4 é…ç½®æ–‡ä»¶bean.xml

```xml
<!-- é…ç½®è´¦æˆ·çš„æŒä¹…å±‚-->
    <bean id="accountDao" class="com.java.dao.impl.AccountDaoImpl">
        <!--<property name="jdbcTemplate" ref="jdbcTemplate"></property>-->
        <property name="jdbcTemplate" ref="jdbcTemplate"></property>
    </bean>

    <!--é…ç½®JdbcTemplate-->
    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
        <property name="dataSource" ref="dataSource"></property>
    </bean>

    <!-- é…ç½®æ•°æ®æº-->
    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"></property>
        <property name="url" value="jdbc:mysql://localhost:3306/db_bank"></property>
        <property name="username" value="root"></property>
        <property name="password" value="123456"></property>
    </bean>
```

### 1.5 æµ‹è¯•è¿ç”¨

```java
package com.java.JdbcTemplate;

import com.java.dao.IAccountDao;
import com.java.model.Account;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.jdbc.core.JdbcTemplate;

/**
 * @author å…¬ä¼—å·:ç¨‹åºå‘˜çš„æ—¶å…‰
 * @create 2020-10-19 19:08
 * @description
 */
public class JdbcTemplateTest4 {
    public static void main(String[] args) {
        //1.è·å–å®¹å™¨
        ApplicationContext ac = new ClassPathXmlApplicationContext("bean.xml");
        //2.è·å–å¯¹è±¡
        IAccountDao accountDao = ac.getBean("accountDao",IAccountDao.class);

        Account account = accountDao.findAccountById(1);
        System.out.println(account);

        /*account.setMoney(30000f);
        accountDao.updateAccount(account);*/
    }
}

```

æˆ‘ä»¬æ¥è¿è¡Œä¸€ä¸‹

![image-20201025193701438](https://gitee.com/Huke-123/PicCloud/raw/master/20201025193701.png)

**é‚£ä¹ˆä¸Šè¿°è¿™ç§æ–¹å¼ï¼Œæ˜¯å­˜åœ¨ä»£ç å†—ä½™çš„ï¼Œæ¯”æ–¹è¯´å¦‚æœæˆ‘æœ‰å¤šä¸ªdaoç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯ä¸€ä¸ªéƒ½éœ€è¦å†™ä»¥ä¸‹é‡å¤ä»£ç ï¼š**

![image-20201025193930630](https://gitee.com/Huke-123/PicCloud/raw/master/20201025193930.png)

æˆ‘ä»¬å¯ä»¥ç”¨ç¬¬äºŒç§æ–¹å¼ç±»è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

## 2 è®©daoç»§æ‰¿JdbcDaoSupport

è¿™æ ·æ—¢å¯ä»¥è§£å†³é‡å¤ä»£ç çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š

### 2.1 åœ¨ä¸Šè¿°åŸºç¡€ä¸Šå†å†™ä¸€ä¸ªå®ç°ç±»

```java
package com.java.dao.impl;

import com.java.dao.IAccountDao;
import com.java.model.Account;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.support.JdbcDaoSupport;

import java.util.List;

public class AccountDaoImpl2 extends JdbcDaoSupport implements IAccountDao {
    
    public Account findAccountById(int accountId) {
        List<Account> accounts= getJdbcTemplate().query("select * from t_account where id = ?",new BeanPropertyRowMapper<Account>(Account.class),accountId);
        return accounts.isEmpty()?null:accounts.get(0);
    }

    public Account findAccountByName(String accountName) {
        List<Account> accounts= getJdbcTemplate().query("select * from t_account where name = ?",new BeanPropertyRowMapper<Account>(Account.class),accountName);
        if(accounts.isEmpty()){
            return null;
        }
        if(accounts.size()>1){
            throw new RuntimeException("ç»“æœé›†ä¸å”¯ä¸€");
        }
        return accounts.get(0);
    }

    public void updateAccount(Account account) {
        getJdbcTemplate().update("update t_account set name=?,money=? where id=?",account.getName(),account.getMoney(),account.getId());
    }
}

```

å¯ä»¥å‘ç°è¿™ä¸ªå®ç°ç±»ä¸­çš„é‡å¤ä»£ç ä¸è§äº†ï¼Œè€Œæ˜¯é‡æ–°ç»§æ‰¿äº†JdbcDaoSupprotç±»ï¼›

### 2.2 å†™ä¸€ä¸ªJdbcDaoSupprotç±»ï¼Œè®©ä¸Šè¿°å®ç°ç±»ç»§æ‰¿å®ƒ

```Java
package com.java.dao.impl;

import org.springframework.jdbc.core.JdbcTemplate;

import javax.sql.DataSource;

public class JdbcDaoSupport {
    private JdbcTemplate jdbcTemplate;

    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public JdbcTemplate getJdbcTemplate() {
        return jdbcTemplate;
    }

    public void setDataSource(DataSource dataSource) {
        if(jdbcTemplate == null){
            jdbcTemplate = createJdbcTemplate(dataSource);
        }
    }

    private JdbcTemplate createJdbcTemplate(DataSource dataSource){
        return new JdbcTemplate(dataSource);
    }
}


```

### 2.3 ä¿®æ”¹é…ç½®æ–‡ä»¶

```xml
<!-- é…ç½®è´¦æˆ·çš„æŒä¹…å±‚-->
    <bean id="accountDao" class="com.java.dao.impl.AccountDaoImpl">
        <!--<property name="jdbcTemplate" ref="jdbcTemplate"></property>-->
        <property name="dataSource" ref="dataSource"></property>
    </bean>

    <!--é…ç½®JdbcTemplate
    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
        <property name="dataSource" ref="dataSource"></property>
    </bean>-->
```

è¿™é‡Œæˆ‘ä»¬ç›´æ¥æ³¨å…¥dataSourceå³å¯ï¼›

### 2.4 æµ‹è¯•è¿ç”¨

![image-20201025201630151](https://gitee.com/Huke-123/PicCloud/raw/master/20201025201630.png)

## 3 ä¸¤ç§æ–¹å¼çš„åŒºåˆ«

> ç¬¬ä¸€ç§æ–¹å¼åœ¨Daoç±»ä¸­å®šä¹‰JdbcTemplateçš„æ–¹å¼ï¼Œé€‚ç”¨äºæ‰€æœ‰é…ç½®æ–¹å¼ï¼ˆxmlå’Œæ³¨è§£éƒ½å¯ä»¥ï¼‰ï¼›
>
> ç¬¬äºŒç§è®©Daoç»§æ‰¿JdbcDaoSupportçš„æ–¹å¼ï¼Œåªèƒ½ç”¨äºåŸºäºXMLçš„æ–¹å¼ï¼Œæ³¨è§£ç”¨ä¸äº†ã€‚

## å°ç»“ï¼š

è¿™èŠ‚æˆ‘ä»¬å­¦ä¹ äº†Springä¸­çš„æ•°æ®åº“ç¼–ç¨‹åœ¨å®é™…å¼€å‘ä¸­çš„åº”ç”¨ï¼Œåœ¨å®é™…å¼€å‘ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨æ•°æ®åº“çš„ã€‚

----

> æ–‡ç« å¯ä»¥ç™½å«–ï¼Œå…¬ä¼—å·ä¸èƒ½ä¸å…³æ³¨ï¼Œæ‰‹åŠ¨æ»‘ç¨½ğŸ¤£ğŸ¤£ &nbsp;
>
> æ¬¢è¿å¤§å®¶å…³æ³¨ï¼š**æ­¦å“¥èŠç¼–ç¨‹**ã€**Javaå¼€å‘å®å…¸**ï¼Œæ‚¨çš„æ”¯æŒï¼Œæ˜¯æˆ‘ä»¬åˆ›ä½œçš„æŒç»­åŠ¨åŠ›ï¼&nbsp;&nbsp;

![æ­¦å“¥èŠç¼–ç¨‹](https://img-blog.csdnimg.cn/202002150421550.jpg)![Javaå¼€å‘å®å…¸](https://img-blog.csdnimg.cn/20200608005630228.png)![Javaç§ƒå¤´å“¥](https://img-blog.csdnimg.cn/20201025170941235.png)

----